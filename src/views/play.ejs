<head>
  <title>Tasty Tails</title>
  <!-- <link rel="stylesheet" type="text/css" href="/css/normalize.css" /> -->
  <link rel="stylesheet" type="text/css" href="/css/index.css" />

  <meta charset="UTF-8">
  <title>Chatting with people you can see</title>
  <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" -->
  <!-- integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous"> -->
  <style>
    footer {
      position: absolute;
      height: 100px;
      top:90%;
      bottom: 0%;
    }
    #voreMenu {
      position: absolute;
      top: 63.5%;
      left: 200px;
      background: #ed2ae5;
      width: 200px;
      height: auto;
      box-shadow: 0 0 20px 0 #ccc;
    }
    .normalMenu {
      float: left;
      background: #f6f6f6;
      width: 200px;
      height: auto;
      box-shadow: 0 0 20px 0 #ccc;
    }
    .context-menu {

      position: absolute;
      display: none;
    }
    .context-menu ul {
      list-style: none;
      padding: 5px 0px 5px 0px;
    }
    .context-menu ul li:not(.separator) {
      padding: 10px 5px 10px 5px;
      border-left: 4px solid transparent;
      cursor: pointer;
    }
    .context-menu ul li:hover {
      background: #eee;
      border-left: 4px solid #666;
    }
    .separator {
      height: 1px;
      background: #dedede;
      margin: 2px 0px 2px 0px;
    }
    .specialActions {
      display: none;
    }
  </style>
</head>

<section id="game">
    <div id="phaserApp" tabindex="0" oncontextmenu="return showContextMenu(event);">
      <div id="intentContainer">
        <input type="radio" name="intent" checked="checked" id="friendly"></input>
        <label for="friendly">Friendly</label>
        <input type="radio" name="intent" id="grabbing"></input>
        <label for="grabbing">Grabbing</label>
        <input type="radio" name="intent" id="hostile"></input>
        <label for="hostile">Hostile</label>
      </div>

      <div id="itemBar">
        <ul>
          <li>
            <div class="item" id="item1" draggable="true"></div>
          </li>
          <li>
            <div class="item" id="item2" draggable="true"></div>
          </li>
          <li>
            <div class="item" id="item3" draggable="true"></div>
          </li>
          <li>
            <div class="item" id="item4" draggable="true"></div>
          </li>
          <li>
            <div class="item" id="item5" draggable="true"></div>
          </li>
        </ul>
      </div>

      <!--Right Click Custom Menu-->
      <div id="contextMenu" class="context-menu">
        <div class="normalMenu" >
          <ul>
            <li id="pickUp">Pick Up</li>
            <li id="special" onmouseover="return specialTestFunction(event);" onmouseout="return specialMouseOut(event)">Special -></li>
          </ul>
        </div>

        <div id="voreMenu" onmouseover="return specialTestFunction(event);" onmouseout="return specialMouseOut(event)">
          <ul id="voreMenuUl">
            <!--<li id="voreContextMenu">test</li>-->
          </ul>
        </div>
      </div>
    </div>

  <div id="sidePanel">

    <div id="menu" tabindex="1">
      <div class="navBar">
        <ul>
          <li class="menuTabs button" id="lookTab">
            Look
          </li>
          <li class="menuTabs button" id="itemsTab">
            Items
          </li>
          <li class="menuTabs button" id="spellsTab">
            Spells
          </li>
          <li class="menuTabs button" id="mapTab">
            Map
          </li>
          <li class="menuTabs button" id="voreTab">
            Vore
          </li>
          <li class="menuTabs button" id="optionsTab">
            Options
          </li>
        </ul>
      </div>

      <div id="menuDisplay">
        <div id="lookDisplay" class="tabDisplay">
          you are in the look tab
        </div>
        <div id="itemsDisplay" class="tabDisplay">
          you are in the items tab
        </div>
        <div id="spellsDisplay" class="tabDisplay">
          you are in the spells tab
          <table id="spellsTable">
            <tr>
              <td id="tableIcon" class="empty">
                <div class="fill" draggable="true"></div>
              </td>
              <td id="tableName" class="empty"></td>
              <td id="tableDescrip" class="empty"></td>
            </tr>
          </table>
        </div>

        <div id="mapDisplay" class="tabDisplay">
          you are in the map tab
        </div>
        <div id="voreDisplay" class="tabDisplay">
          <div id="voreTypesInGame">
            <h1>Vore Anatomy</h1>
            <ul id="voreList">

            </ul>
            <!-- <button type="button" id="addVore" class="button main"><span>Add New Vore</span></button> -->
          </div>
          <div id="chamberContents">
            <h1>Chamber Contents</h1>
            <ul id="chamberContentsList">

            </ul>
          </div>
        </div>
        <div id="optionsDisplay" class="tabDisplay">
          you are in the options tab
        </div>
      </div>
    </div>

    <!--Chat Box-->
    <!-- <div id="chat-container">
      <div class="container-fluid">
        <div class="row">
          <ul id="messages"></ul>
        </div>
        <div class="row">
          <div class="col-xs-12">
            <form id="message-form" action="">
              <div class="input-group">
                <textarea id="m" autocomplete="off" class="form-control" placeholder="message" aria-label="message"></textarea>

              </div>
            </form>
          </div>
        </div>
      </div>
    </div> -->
    <!-- New Chat HTML -->
    <!-- <button id="clearBtn">Clear</button>
    <div id="status"> -->

    <div id="chat">
      <!-- <input type="text" id="username" class="form-control" placeholder="Enter name..."> -->
      <div class="chat-holder">
        <div id="messages" >

        </div>
        <div id="message-box-container">
          <div class="control-btn-container">
            <button id="bold-btn" class="chat-control-btn tool-tip material-icons" name="bold-ctl" data-tooltip='Click or press "Ctrl B" to bold text.'>&#xe238;</button>
            <button id="italic-btn" class="chat-control-btn tool-tip material-icons" name="italic-ctl" data-tooltip='Click or press "Ctrl I" to italicize text.'>&#xe23f;</button>
            <button id="underline-btn" class="chat-control-btn tool-tip material-icons" name="underline-ctl" data-tooltip='Click or press "Ctrl U" to underline text.'>&#xe249;</button>
            <button id="strikethrough-btn" class="chat-control-btn tool-tip material-icons" name="strikethrough-ctl" data-tooltip='Click or press "Ctrl S" to strikethrough text.'>&#xe257;</button>
            <button id="subscript-btn" class="chat-control-btn tool-tip material-icons" name="subscript-ctl" data-tooltip='Click or press "Ctrl -" to subscript text.'>&#xf111;</button>
            <button id="superscript-btn" class="chat-control-btn tool-tip material-icons" name="superscript-ctl" data-tooltip='Click or press "Ctrl +" to superscript text.'>&#xf112;</button>

            <div id="spoiler-container"  class="tool-tip" data-tooltip='Select to hide message content.'>
              <label id="spoiler-label" for="spoilers" class="material-icons">&#xe8f4;</label>
              <select id="spoilers" name="spoilers">
                <option value="none"><div class="optionLabel">Not Spoiled</div></option>
                <option value="general" style="background-image:url('https://fonts.gstatic.com/s/i/materialicons/visibility/v16/24px.svg');">General</option>
                <option value="watersports">Watersports</option>
                <option value="disposal">Scat/Disposal</option>
                <option value="gore">Gore</option>
              </select>
            </div>

            <div class="dropdown" data-dropdown>
              <button class="link chat-control-btn material-icons" data-dropdown-button>&#xe8b8;</button>
              <div class="dropdown-menu information-grid">
                <div>
                  <div class="dropdown-heading">
                    Spoiler Preferences
                  </div>
                  <div class="dropdown-links">
                    <ul>
                      <li>
                        <input type="checkbox" id="watersportsBox" name="watersportsBox" checked="True">
                        <label for="watersportsBox">Hide Watersports by Default</label><br>
                      </li>
                      <li>
                        <input type="checkbox" id="disposalBox" name="disposal" checked="True">
                        <label for="disposalBox">Hide Scat/Disposal by Default</label><br>
                      </li>
                      <li>
                        <input type="checkbox" id="goreBox" name="goreBox" checked="True">
                        <label for="goreBox">Hide Gore by Default</label><br>
                      </li>
                    </ul>
                  </div>
                </div>

                <div>
                  <div class="dropdown-heading">
                    Settings 2
                  </div>
                  <div class="dropdown-links">
                      <a href="#" class="link">Test link 2</a>
                  </div>
                </div>

                <div>
                  <div class="dropdown-heading">
                    Settings 3
                  </div>
                  <div class="dropdown-links">
                      <a href="#" class="link">Test link 3</a>
                  </div>
                </div>

                <div>
                  <div class="dropdown-heading">
                    Settings 4
                  </div>
                  <div class="dropdown-links">
                      <a href="#" class="link">Test link 4</a>
                  </div>
                </div>

                <div>
                  <div class="dropdown-heading">
                    Settings 5
                  </div>
                  <div class="dropdown-links">
                      <a href="#" class="link">Test link 5</a>
                  </div>
                </div>

                <div>
                  <div class="dropdown-heading">
                    Settings 6
                  </div>
                  <div class="dropdown-links">
                      <a href="#" class="link">Test link 6</a>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div id="textarea" contenteditable="true" spellcheck="true" class="form-control" placeholder="Enter message...">

          </div>
          <div class="charlimit">
            0/10000
          </div>
        </div>
      </div>
    </div>

    </div>











  <script src="https://cdn.jsdelivr.net/npm/phaser@3.55.2/dist/phaser.min.js"></script>
  <script src="/socket.io/socket.io.js"></script>
  <!-- <script type="module" src="/js/index.js"></script> -->
  <!-- <script type="module">
    const serverPlayerInfo = <% charList %>
    console.log('serverPlayerInfo = ', serverPlayerInfo);
    export serverPlayerInfo;
  </script> -->
  <!--Checks if the game is focused or the chat is focused-->
  <script>
    function alertFunction() {
      alert("this button does not work right now... Just press the ENTER key to send your message.");
    }
    var chatFocused = true;



    function windowSize(){
      // var windowSize = {
      //   x: window.innerWidth/2,
      //   y: window.innerHeight/2
      // }
      var windowSize = {
        x: document.getElementById('phaserApp').clientWidth,
        y: document.getElementById('phaserApp').clientHeight
      }
      console.log('windowSize = ', windowSize);
      return windowSize;
    }



    window.onclick = hideContextMenu;
    window.onkeydown = listenKeys;
    var contextMenu = document.getElementById('contextMenu');
    function showContextMenu (event) {
      contextMenu.style.display = 'block';
      voreMenu.style.display = 'none';
      contextMenu.style.left = event.clientX + 'px';
      contextMenu.style.top = event.clientY + 'px';
      return false;
    }

    function hideContextMenu () {
      // const contextMenu = document.getElementById('contextMenu');
      console.log('hiding Context Menu');
      contextMenu.style.display = 'none';
      // contextMenu.remove();
      if (document.querySelector("#contextMenu > playermenu")) {
        const toRemove = document.querySelector("#contextMenu > playermenu");
        toRemove.remove();
      }
    }
    function listenKeys (event) {
      var keyCode = event.which || event.keyCode;
      // console.log('listenkeys function keyCode = ', keyCode);
      if(keyCode == 27){
        hideContextMenu();
      }
    }

    var voreMenu = document.getElementById('voreMenu');
    function specialTestFunction (event) {
      //alert("You did a hover thingy!");
      voreMenu.style.display = 'block';
      //voreMenu.style.left = event.clientX + 'px';
      //voreMenu.style.top = event.clientY + 'px';
      return false;
    }
    function specialMouseOut (event) {
      voreMenu.style.display = 'none';
      return false;
    }











    var avatarSelected = false;

    let avatarInfo = {
      head:"emptyplayer",
      body:"emptyplayer"
    };

    var rawCharList = `<%- JSON.stringify(charList)
    .replace(/\\/g, '\\\\')
    .replace(/'/g, '\\\'')
    .replace(/"/g, '&quot;')
    .replace(/\n/g, '\\n')
    .replace(/\r/g, '\\r')
    .replace(/\u2028/g, '\\u2028')
    .replace(/\u2029/g, '\\u2029') %>`;
    var charList = JSON.parse(rawCharList.replace(/&quot;/g, '"'));

    var localPlayerInfo = charList
    localPlayerInfo.position.x = 3291;
    localPlayerInfo.position.y = 4287;
    // localPlayerInfo.consumedBy = null;
    localPlayerInfo.rotation = 0;
    localPlayerInfo.isMoving = false;
    // localPlayerInfo.Identifier = "player";
    // localPlayerInfo.input = {
    //   left: false,
    //   right: false,
    //   up: false,
    //   down: false
    // };



    var voreTypes = [];
    var clicked = {Identifier: ''};
    var toDestroy = '';
    var container = null;
    var cam1 = null;
    var arrows = 0;










    let config = {
      type: Phaser.AUTO,
      parent: 'phaser-example',
      width: windowSize().x,//800,//window.innerWidth,
      height: windowSize().y,//930,//window.innerHeight,
      parent: 'phaserApp',
      physics: {
        default: 'arcade',
    		arcade: {
    			debug: true
        }
      },
      scene: {
        preload: preload,
        create: create,
        update: update
      }
    };

    var game = new Phaser.Game(config);
    var showDebug = false;
    var blocked_tiles;
    var obj_spawning;
    var helpText;
    //----- This function is called when drawing the debug collision lines -----//
    function drawDebug (collidingTiles) {
      console.log('collidingTiles = ', collidingTiles);
      debugGraphics.clear();
      if (showDebug) {
        console.log('debug button pressed');
        // let allTiles = blocked_tiles.getTilesWithin(0, 0, blocked_tiles.width, blocked_tiles.height);
        // let collidingTiles = allTiles.filter(tile => tile.collides);

        collidingTiles.forEach(tile => {
          let x = tile.pixelX;
          let y = tile.pixelY;
          let width = tile.width;
          let height = tile.height;
          debugGraphics.strokeRect(x, y, width, height);
        });
      }
      helpText.setText(getHelpMessage());
    }


    function getHelpMessage () {
      return 'Arrow keys to move.' +
      '\nPress "C" to toggle debug visuals: ' + (showDebug ? 'on' : 'off');
    }

    //----- Shows the current FrameRate of the game -----//
    function getFrameRate() {
      // frameRate.setText('FrameRate: ' + game.loop.actualFps.toFixed(2));
    }

    function preload() {
      console.log('Preload Started');
      let progressBar = this.add.graphics();
    		let progressBarHolder = this.add.graphics();
    		progressBarHolder.fillStyle(0x222222, 0.8);
    		progressBarHolder.fillRect(335, 170, 320, 50);
    		/* //This seems to tick through individual files, which isn't so useful.
    		boot.load.on('fileprogress', function (file, value) {
    			console.log("File progress event: ", file, ", ", value);
    		}); */
    		//This seems to capture a total ratio (between 0.0 and 1.0)
    		this.load.on('progress', function (ratio) {
    			progressBar.clear();
    			progressBar.fillStyle(0xffffff, 1);
    			progressBar.fillRect(345, 180, 300 * ratio, 30);
    		});

    		this.load.on('complete', function () {
    			progressBar.destroy();
    			progressBarHolder.destroy();
    		});
      // this.load.image('spritesheet', './../assets/images/spritesheet.png');
      this.load.image('tileset', './../assets/tilemaps/tileset.png');
      this.load.spritesheet('tilesetSprite', './../assets/tilemaps/tileset.png', {frameWidth: 32, frameHeight: 32});
      this.load.image('scroll', './../assets/images/Scroll_01.png')
      this.load.image('scroll2', './../assets/images/Scroll_02.png')

      this.spritesToAnimate = []; // Initialize the array
    this.load.spritesheet('empty', './../assets/spritesheets/empty.png', {frameWidth: 109, frameHeight: 220});
    this.spritesToAnimate.push('empty');
    this.load.spritesheet('body_01-empty', './../assets/spritesheets/empty.png', {frameWidth: 109, frameHeight: 220});
    this.spritesToAnimate.push('body_01-empty');
    this.load.spritesheet('body_02-empty', './../assets/spritesheets/empty.png', {frameWidth: 109, frameHeight: 220});
    this.spritesToAnimate.push('body_02-empty');
    this.load.spritesheet('body_03-empty', './../assets/spritesheets/empty.png', {frameWidth: 109, frameHeight: 220});
    this.spritesToAnimate.push('body_03-empty');
    this.load.spritesheet('body_04-empty', './../assets/spritesheets/empty.png', {frameWidth: 109, frameHeight: 220});
    this.spritesToAnimate.push('body_04-empty');



    // Body Sprites
    this.load.spritesheet('body_01', './../assets/spritesheets/body_01.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('body_01');

    // Secondary Body Sprites
    this.load.spritesheet('body_01-secondary_01', './../assets/spritesheets/body_01-secondary_01.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('body_01-secondary_01');
    this.load.spritesheet('body_01-secondary_02', './../assets/spritesheets/body_01-secondary_02.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('body_01-secondary_02');
    this.load.spritesheet('body_01-secondary_03', './../assets/spritesheets/body_01-secondary_03.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('body_01-secondary_03');
    this.load.spritesheet('body_01-secondary_04', './../assets/spritesheets/body_01-secondary_04.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('body_01-secondary_04');


    // Accent Body Sprites
    this.load.spritesheet('body_01-accent_01', './../assets/spritesheets/body_01-accent_01.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('body_01-accent_01');
    this.load.spritesheet('body_01-accent_02', './../assets/spritesheets/body_01-accent_02.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('body_01-accent_02');
    this.load.spritesheet('body_01-accent_03', './../assets/spritesheets/body_01-accent_03.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('body_01-accent_03');

    // Hand Secondary Sprites
    this.load.spritesheet('body_01-hands-secondary_01', './../assets/spritesheets/body_01-hands-secondary_01.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('body_01-hands-secondary_01');
    this.load.spritesheet('body_01-hands-secondary_02', './../assets/spritesheets/body_01-hands-secondary_02.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('body_01-hands-secondary_02');


    // Feet Secondary Sprites
    this.load.spritesheet('body_01-feet-secondary_01', './../assets/spritesheets/body_01-feet-secondary_01.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('body_01-feet-secondary_01');
    this.load.spritesheet('body_01-feet-secondary_02', './../assets/spritesheets/body_01-feet-secondary_02.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('body_01-feet-secondary_02');








    // Ear Sprites
    this.load.spritesheet('ears_01-outer', './../assets/spritesheets/ears_01-outer.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('ears_01-outer');
    this.load.spritesheet('ears_01-inner', './../assets/spritesheets/ears_01-inner.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('ears_01-inner');

    this.load.spritesheet('ears_02-outer', './../assets/spritesheets/ears_02-outer.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('ears_02-outer');
    this.load.spritesheet('ears_02-inner', './../assets/spritesheets/ears_02-inner.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('ears_02-inner');

    this.load.spritesheet('ears_03-outer', './../assets/spritesheets/ears_03-outer.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('ears_03-outer');
    this.load.spritesheet('ears_03-inner', './../assets/spritesheets/ears_03-inner.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('ears_03-inner');

    this.load.spritesheet('ears_04-outer', './../assets/spritesheets/ears_04-outer.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('ears_04-outer');
    this.load.spritesheet('ears_04-inner', './../assets/spritesheets/ears_04-inner.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('ears_04-inner');

    this.load.spritesheet('ears_05-outer', './../assets/spritesheets/ears_05-outer.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('ears_05-outer');
    this.load.spritesheet('ears_05-inner', './../assets/spritesheets/ears_05-inner.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('ears_05-inner');

    this.load.spritesheet('ears_06-outer', './../assets/spritesheets/ears_06-outer.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('ears_06-outer');
    this.load.spritesheet('ears_06-inner', './../assets/spritesheets/ears_06-inner.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('ears_06-inner');

    this.load.spritesheet('ears_07-outer', './../assets/spritesheets/ears_07-outer.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('ears_07-outer');
    this.load.spritesheet('ears_07-inner', './../assets/spritesheets/ears_07-inner.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('ears_07-inner');

    this.load.spritesheet('ears_08-outer', './../assets/spritesheets/ears_08-outer.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('ears_08-outer');
    this.load.spritesheet('ears_08-inner', './../assets/spritesheets/ears_08-inner.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('ears_08-inner');

    this.load.spritesheet('ears_09-outer', './../assets/spritesheets/ears_09-outer.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('ears_09-outer');
    this.load.spritesheet('ears_09-inner', './../assets/spritesheets/ears_09-inner.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('ears_09-inner');

    this.load.spritesheet('ears_10-outer', './../assets/spritesheets/ears_10-outer.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('ears_10-outer');
    this.load.spritesheet('ears_10-inner', './../assets/spritesheets/ears_10-inner.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('ears_10-inner');

    this.load.spritesheet('ears_11-outer', './../assets/spritesheets/ears_11-outer.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('ears_11-outer');
    this.load.spritesheet('ears_11-inner', './../assets/spritesheets/ears_11-inner.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('ears_11-inner');


    // Eyes Sprites
    this.load.spritesheet('eyes_01', './../assets/spritesheets/eyes_01.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('eyes_01');
    this.load.spritesheet('eyes_02', './../assets/spritesheets/eyes_02.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('eyes_02');

    // Head Accessories
    this.load.spritesheet('headAccessories_01', './../assets/spritesheets/headAccessories_01.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('headAccessories_01');
    this.load.spritesheet('headAccessories_02', './../assets/spritesheets/headAccessories_02.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('headAccessories_02');
    this.load.spritesheet('headAccessories_03', './../assets/spritesheets/headAccessories_03.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('headAccessories_03');
    this.load.spritesheet('headAccessories_04', './../assets/spritesheets/headAccessories_04.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('headAccessories_04');
    this.load.spritesheet('headAccessories_05', './../assets/spritesheets/headAccessories_05.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('headAccessories_05');


    
    // Head Sprites
    this.load.spritesheet('head_01', './../assets/spritesheets/head_01.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('head_01');
    this.load.spritesheet('head_02', './../assets/spritesheets/head_02.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('head_02');
    this.load.spritesheet('head_03', './../assets/spritesheets/head_03.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('head_03');
    this.load.spritesheet('head_04', './../assets/spritesheets/head_04.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('head_04');
    this.load.spritesheet('head_05', './../assets/spritesheets/head_05.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('head_05');
    this.load.spritesheet('head_06', './../assets/spritesheets/head_06.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('head_06');


    // Secondary Head Sprites for head_01
    this.load.spritesheet('head_01-secondary_01', './../assets/spritesheets/head_01-secondary_01.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('head_01-secondary_01');
    this.load.spritesheet('head_01-secondary_02', './../assets/spritesheets/head_01-secondary_02.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('head_01-secondary_02');
    this.load.spritesheet('head_01-secondary_03', './../assets/spritesheets/head_01-secondary_03.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('head_01-secondary_03');
    this.load.spritesheet('head_01-secondary_04', './../assets/spritesheets/head_01-secondary_04.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('head_01-secondary_04');
    this.load.spritesheet('head_01-secondary_05', './../assets/spritesheets/head_01-secondary_05.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('head_01-secondary_05');

    // Secondary Head Sprites for head_02
    this.load.spritesheet('head_02-secondary_01', './../assets/spritesheets/head_02-secondary_01.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('head_02-secondary_01');
    this.load.spritesheet('head_02-secondary_02', './../assets/spritesheets/head_02-secondary_02.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('head_02-secondary_02');
    this.load.spritesheet('head_02-secondary_03', './../assets/spritesheets/head_02-secondary_03.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('head_02-secondary_03');
    this.load.spritesheet('head_02-secondary_04', './../assets/spritesheets/head_02-secondary_04.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('head_02-secondary_04');
    this.load.spritesheet('head_02-secondary_05', './../assets/spritesheets/head_02-secondary_05.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('head_02-secondary_05');

    // Secondary Head Sprites for head_03
    this.load.spritesheet('head_03-secondary_01', './../assets/spritesheets/head_03-secondary_01.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('head_03-secondary_01');
    this.load.spritesheet('head_03-secondary_02', './../assets/spritesheets/head_03-secondary_02.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('head_03-secondary_02');
    this.load.spritesheet('head_03-secondary_03', './../assets/spritesheets/head_03-secondary_03.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('head_03-secondary_03');
    this.load.spritesheet('head_03-secondary_04', './../assets/spritesheets/head_03-secondary_04.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('head_03-secondary_04');
    this.load.spritesheet('head_03-secondary_05', './../assets/spritesheets/head_03-secondary_05.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('head_03-secondary_05');

    // Secondary Head Sprites for head_04
    this.load.spritesheet('head_04-secondary_01', './../assets/spritesheets/head_04-secondary_01.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('head_04-secondary_01');
    this.load.spritesheet('head_04-secondary_02', './../assets/spritesheets/head_04-secondary_02.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('head_04-secondary_02');
    this.load.spritesheet('head_04-secondary_03', './../assets/spritesheets/head_04-secondary_03.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('head_04-secondary_03');
    this.load.spritesheet('head_04-secondary_04', './../assets/spritesheets/head_04-secondary_04.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('head_04-secondary_04');
    this.load.spritesheet('head_04-secondary_05', './../assets/spritesheets/head_04-secondary_05.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('head_04-secondary_05');

    // Secondary Head Sprites for head_05
    this.load.spritesheet('head_05_beak', './../assets/spritesheets/head_05_beak.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('head_05_beak');
    this.load.spritesheet('head_05-secondary_01', './../assets/spritesheets/head_05-secondary_01.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('head_05-secondary_01');
    this.load.spritesheet('head_05-secondary_02', './../assets/spritesheets/head_05-secondary_02.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('head_05-secondary_02');
    this.load.spritesheet('head_05-secondary_03', './../assets/spritesheets/head_05-secondary_03.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('head_05-secondary_03');
    this.load.spritesheet('head_05-secondary_04', './../assets/spritesheets/head_05-secondary_04.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('head_05-secondary_04');
    this.load.spritesheet('head_05-secondary_05', './../assets/spritesheets/head_05-secondary_05.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('head_05-secondary_05');

    // Secondary Head Sprites for head_06
    this.load.spritesheet('head_06-secondary_01', './../assets/spritesheets/head_06-secondary_01.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('head_06-secondary_01');
    this.load.spritesheet('head_06-secondary_02', './../assets/spritesheets/head_06-secondary_02.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('head_06-secondary_02');
    this.load.spritesheet('head_06-secondary_03', './../assets/spritesheets/head_06-secondary_03.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('head_06-secondary_03');
    this.load.spritesheet('head_06-secondary_04', './../assets/spritesheets/head_06-secondary_04.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('head_06-secondary_04');
    this.load.spritesheet('head_06-secondary_05', './../assets/spritesheets/head_06-secondary_05.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('head_06-secondary_05');

    // Tail Sprites
    this.load.spritesheet('tail_01', './../assets/spritesheets/tail_01.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_01');
    this.load.spritesheet('tail_02', './../assets/spritesheets/tail_02.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_02');
    this.load.spritesheet('tail_03', './../assets/spritesheets/tail_03.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_03');
    this.load.spritesheet('tail_04', './../assets/spritesheets/tail_04.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_04');
    this.load.spritesheet('tail_05', './../assets/spritesheets/tail_05.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_05');
    this.load.spritesheet('tail_06', './../assets/spritesheets/tail_06.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_06');
    this.load.spritesheet('tail_07', './../assets/spritesheets/tail_07.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_07');


    // Secondary Tail Sprites for tail_01
    this.load.spritesheet('tail_01-secondary_01', './../assets/spritesheets/tail_01-secondary_01.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_01-secondary_01');
    this.load.spritesheet('tail_01-secondary_02', './../assets/spritesheets/tail_01-secondary_02.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_01-secondary_02');
    this.load.spritesheet('tail_01-secondary_03', './../assets/spritesheets/tail_01-secondary_03.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_01-secondary_03');
    this.load.spritesheet('tail_01-secondary_04', './../assets/spritesheets/tail_01-secondary_04.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_01-secondary_04');
    this.load.spritesheet('tail_01-secondary_05', './../assets/spritesheets/tail_01-secondary_05.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_01-secondary_05');
    this.load.spritesheet('tail_01-secondary_06', './../assets/spritesheets/tail_01-secondary_06.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_01-secondary_06');

    // Secondary Tail Sprites for tail_02
    this.load.spritesheet('tail_02-secondary_01', './../assets/spritesheets/tail_02-secondary_01.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_02-secondary_01');
    this.load.spritesheet('tail_02-secondary_02', './../assets/spritesheets/tail_02-secondary_02.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_02-secondary_02');
    this.load.spritesheet('tail_02-secondary_03', './../assets/spritesheets/tail_02-secondary_03.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_02-secondary_03');
    this.load.spritesheet('tail_02-secondary_04', './../assets/spritesheets/tail_02-secondary_04.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_02-secondary_04');
    this.load.spritesheet('tail_02-secondary_05', './../assets/spritesheets/tail_02-secondary_05.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_02-secondary_05');
    this.load.spritesheet('tail_02-secondary_06', './../assets/spritesheets/tail_02-secondary_06.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_02-secondary_06');

    // Secondary Tail Sprites for tail_03
    this.load.spritesheet('tail_03-secondary_01', './../assets/spritesheets/tail_03-secondary_01.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_03-secondary_01');
    this.load.spritesheet('tail_03-secondary_02', './../assets/spritesheets/tail_03-secondary_02.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_03-secondary_02');
    this.load.spritesheet('tail_03-secondary_03', './../assets/spritesheets/tail_03-secondary_03.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_03-secondary_03');
    this.load.spritesheet('tail_03-secondary_04', './../assets/spritesheets/tail_03-secondary_04.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_03-secondary_04');
    this.load.spritesheet('tail_03-secondary_05', './../assets/spritesheets/tail_03-secondary_05.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_03-secondary_05');
    this.load.spritesheet('tail_03-secondary_06', './../assets/spritesheets/tail_03-secondary_06.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_03-secondary_06');

    // Secondary Tail Sprites for tail_04
    this.load.spritesheet('tail_04-secondary_01', './../assets/spritesheets/tail_04-secondary_01.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_04-secondary_01');
    this.load.spritesheet('tail_04-secondary_02', './../assets/spritesheets/tail_04-secondary_02.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_04-secondary_02');
    this.load.spritesheet('tail_04-secondary_03', './../assets/spritesheets/tail_04-secondary_03.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_04-secondary_03');
    this.load.spritesheet('tail_04-secondary_04', './../assets/spritesheets/tail_04-secondary_04.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_04-secondary_04');
    this.load.spritesheet('tail_04-secondary_05', './../assets/spritesheets/tail_04-secondary_05.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_04-secondary_05');
    this.load.spritesheet('tail_04-secondary_06', './../assets/spritesheets/tail_04-secondary_06.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_04-secondary_06');

    // Secondary Tail Sprites for tail_05
    this.load.spritesheet('tail_05-secondary_01', './../assets/spritesheets/tail_05-secondary_01.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_05-secondary_01');
    this.load.spritesheet('tail_05-secondary_02', './../assets/spritesheets/tail_05-secondary_02.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_05-secondary_02');
    this.load.spritesheet('tail_05-secondary_03', './../assets/spritesheets/tail_05-secondary_03.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_05-secondary_03');
    this.load.spritesheet('tail_05-secondary_04', './../assets/spritesheets/tail_05-secondary_04.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_05-secondary_04');
    this.load.spritesheet('tail_05-secondary_05', './../assets/spritesheets/tail_05-secondary_05.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_05-secondary_05');
    this.load.spritesheet('tail_05-secondary_06', './../assets/spritesheets/tail_05-secondary_06.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_05-secondary_06');

    // Secondary Tail Sprites for tail_06
    this.load.spritesheet('tail_06-secondary_01', './../assets/spritesheets/tail_06-secondary_01.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_06-secondary_01');
    this.load.spritesheet('tail_06-secondary_02', './../assets/spritesheets/tail_06-secondary_02.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_06-secondary_02');
    this.load.spritesheet('tail_06-secondary_03', './../assets/spritesheets/tail_06-secondary_03.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_06-secondary_03');
    this.load.spritesheet('tail_06-secondary_04', './../assets/spritesheets/tail_06-secondary_04.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_06-secondary_04');
    this.load.spritesheet('tail_06-secondary_05', './../assets/spritesheets/tail_06-secondary_05.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_06-secondary_05');
    this.load.spritesheet('tail_06-secondary_06', './../assets/spritesheets/tail_06-secondary_06.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_06-secondary_06');

    // Secondary Tail Sprites for tail_07
    this.load.spritesheet('tail_07-secondary_01', './../assets/spritesheets/tail_07-secondary_01.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_07-secondary_01');
    this.load.spritesheet('tail_07-secondary_02', './../assets/spritesheets/tail_07-secondary_02.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_07-secondary_02');
    this.load.spritesheet('tail_07-secondary_03', './../assets/spritesheets/tail_07-secondary_03.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_07-secondary_03');
    this.load.spritesheet('tail_07-secondary_04', './../assets/spritesheets/tail_07-secondary_04.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_07-secondary_04');
    this.load.spritesheet('tail_07-secondary_05', './../assets/spritesheets/tail_07-secondary_05.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_07-secondary_05');
    this.load.spritesheet('tail_07-secondary_06', './../assets/spritesheets/tail_07-secondary_06.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_07-secondary_06');

    // Secondary Tail Sprites for tail_08
    this.load.spritesheet('tail_08-secondary_01', './../assets/spritesheets/tail_08-secondary_01.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_08-secondary_01');
    this.load.spritesheet('tail_08-secondary_02', './../assets/spritesheets/tail_08-secondary_02.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_08-secondary_02');
    this.load.spritesheet('tail_08-secondary_03', './../assets/spritesheets/tail_08-secondary_03.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_08-secondary_03');
    this.load.spritesheet('tail_08-secondary_04', './../assets/spritesheets/tail_08-secondary_04.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_08-secondary_04');
    this.load.spritesheet('tail_08-secondary_05', './../assets/spritesheets/tail_08-secondary_05.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_08-secondary_05');
    this.load.spritesheet('tail_08-secondary_06', './../assets/spritesheets/tail_08-secondary_06.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_08-secondary_06');

    // Secondary Tail Sprites for tail_09
    this.load.spritesheet('tail_09-secondary_01', './../assets/spritesheets/tail_09-secondary_01.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_09-secondary_01');
    this.load.spritesheet('tail_09-secondary_02', './../assets/spritesheets/tail_09-secondary_02.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_09-secondary_02');
    this.load.spritesheet('tail_09-secondary_03', './../assets/spritesheets/tail_09-secondary_03.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_09-secondary_03');
    this.load.spritesheet('tail_09-secondary_04', './../assets/spritesheets/tail_09-secondary_04.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_09-secondary_04');
    this.load.spritesheet('tail_09-secondary_05', './../assets/spritesheets/tail_09-secondary_05.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_09-secondary_05');
    this.load.spritesheet('tail_09-secondary_06', './../assets/spritesheets/tail_09-secondary_06.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_09-secondary_06');

    // Secondary Tail Sprites for tail_10
    this.load.spritesheet('tail_10-secondary_01', './../assets/spritesheets/tail_10-secondary_01.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_10-secondary_01');
    this.load.spritesheet('tail_10-secondary_02', './../assets/spritesheets/tail_10-secondary_02.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_10-secondary_02');
    this.load.spritesheet('tail_10-secondary_03', './../assets/spritesheets/tail_10-secondary_03.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_10-secondary_03');
    this.load.spritesheet('tail_10-secondary_04', './../assets/spritesheets/tail_10-secondary_04.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_10-secondary_04');
    this.load.spritesheet('tail_10-secondary_05', './../assets/spritesheets/tail_10-secondary_05.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_10-secondary_05');
    this.load.spritesheet('tail_10-secondary_06', './../assets/spritesheets/tail_10-secondary_06.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('tail_10-secondary_06');


    // Hair Sprites
    this.load.spritesheet('hair-front_01', './../assets/spritesheets/hair-front_01.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('hair-front_01');
    this.load.spritesheet('hair-front_02', './../assets/spritesheets/hair-front_02.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('hair-front_02');
    this.load.spritesheet('hair-front_03', './../assets/spritesheets/hair-front_03.png', {frameWidth: 215, frameHeight: 198});
    this.spritesToAnimate.push('hair-front_03');


      //This loads the map json file that says what coordinates have what pictures
      // this.load.tilemapTiledJSON('level_2', './../assets/tilemaps/level2.json');
      this.load.tilemapTiledJSON('tastytails_v01', './../assets/tilemaps/tastytails_v01.json');

      //----- Loads images used for interactive objects -----//
      this.load.image('tree_01', './../assets/tilemaps/tree_01.png');
      this.load.image('tree_02', './../assets/tilemaps/tree_02.png');
      this.load.image('lamp_01', './../assets/tilemaps/lamp_01.png');
      this.load.image('lamp_02', './../assets/tilemaps/lamp_02.png');
      this.load.image('cloth_shelf_01', './../assets/tilemaps/cloth_shelf_01.png');
      this.load.image('cloth_shelf_02', './../assets/tilemaps/cloth_shelf_02.png');
      this.load.image('mirror_01', './../assets/tilemaps/mirror_01.png');
      this.load.image('mannequin_00', './../assets/tilemaps/mannequin_00.png');
      this.load.image('mannequin_01', './../assets/tilemaps/mannequin_01.png');
      this.load.image('mannequin_02', './../assets/tilemaps/mannequin_02.png');
      this.load.image('sewing_machine_01', './../assets/tilemaps/sewing_machine_01.png');
      this.load.image('cloth_roll_basket01', './../assets/tilemaps/cloth_roll_basket01.png');
      this.load.image('yarn_basket_01', './../assets/tilemaps/yarn_basket_01.png');

      this.load.image('pub_table', './../assets/tilemaps/pub_table.png');
      this.load.image('pub_stool', './../assets/tilemaps/pub_stool.png');
      this.load.image('bar_front', './../assets/tilemaps/bar_front.png');
      this.load.image('card_table', './../assets/tilemaps/card_table.png');
      this.load.image('pub_stool_tall', './../assets/tilemaps/pub_stool_tall.png');

      this.load.image('spa_massage_bed', './../assets/tilemaps/spa_massage_bed.png');


      //----- Doors -----//
      this.load.spritesheet('door_clothing_store', './../assets/spritesheets/door_clothing_store.png', {frameWidth: 197, frameHeight: 255});
      this.load.image('clothing_store_exit_rug', './../assets/tilemaps/clothing_store_exit_rug.png');

      this.load.spritesheet('door_pub', './../assets/spritesheets/door_pub.png', {frameWidth: 197, frameHeight: 255});
      this.load.image('pub_exit_rug', './../assets/tilemaps/pub_exit_rug.png');

      this.load.spritesheet('door_spa', './../assets/spritesheets/door_spa.png', {frameWidth: 197, frameHeight: 255});
    }

    function create() {
      window.addEventListener("resize", windowResize);
      function windowResize(e){
        console.log('e = ', e);
        var phaserWindow = {
          x: document.getElementById('phaserApp').clientWidth,
          y: document.getElementById('phaserApp').clientHeight
        }
        console.log('phaserWindow = ', phaserWindow);
        game.scale.resize(phaserWindow.x, phaserWindow.y);
        // cam1.setSize(phaserWindow.x, phaserWindow.y);
      }

      var test = 'receiving on socket connection?';
      var self = this;
      this.players = this.add.group();
      this.physics.add.collider(this.players);
      this.socket = io();
      console.log('this.socket = ', this.socket);
      this.socket.emit('getAllChats', {
        token: document.cookie.replace('TastyTails=',''),
        charId: document.location.href.split('play/')[1]}
      )

      var otherPlayers = [];

      this.socket.on('currentPlayers', function (players, spells) {
        Object.keys(players).forEach(function (id) {
          console.log('Local players socket ID = ', players[id].playerId);
          if (players[id].playerId === self.socket.id) {
            localPlayerInfo.playerId = self.socket.id;
            self.socket.emit('characterUpdate', localPlayerInfo);
            //addPlayer(self, players[id]);
          } else {
            displayOtherPlayers(self, players[id]);
          }
        });
        spawnSpells(spells);
      });

      this.socket.on('newPlayer', function (playerInfo) {
        displayOtherPlayers(self, playerInfo);
      });

      this.socket.on('characterUpdated', function (playerInfo) {
        //console.log('characterUpdated is called');
        //console.log('characterUpdated', '\n', 'playerInfo.playerId = ', playerInfo.playerId, '\n', 'self.socket.id = ', self.socket.id);
          if (playerInfo.playerId === self.socket.id) {
            //console.log('playerInfo.playerId === self.socket.id');
            displayPlayers(self, playerInfo);
          }
          for (let i = 0; i < otherPlayers.length; i++) {
            //let movingPlayer = otherPlayers[i];
            if (playerInfo.playerId === otherPlayers[i].playerId) {
              displayOtherPlayers(self, playerInfo);
              console.log(playerInfo.playerId, 'chose username: ', playerInfo.username, '\n', 'Set head to: ', playerInfo.head, 'and body to: ', playerInfo.body, '\n', 'and head color to:', playerInfo.headColor,  'and body color to:', playerInfo.bodyColor, 'and they have described themselves as: ', playerInfo.descrip);
              return;
            }
          }
      });
      this.socket.on('avatarSelection', function (playerInfo) {
        /*self.otherPlayers.getChildren().forEach(function (otherPlayer) {
          if (playerInfo.playerId === otherPlayer.playerId) {
            displayOtherPlayers(self, playerInfo);
            console.log(playerInfo.playerId, 'chose username: ', playerInfo.username, '\n', 'Set head to: ', playerInfo.head, 'and body to: ', playerInfo.body, '\n', 'and head color to:', playerInfo.headColor,  'and body color to:', playerInfo.bodyColor, 'and they have described themselves as: ', playerInfo.descrip);
          }
        });*/
      });

      this.socket.on('removePlayer', function (playerId) {
        self.players.getChildren().forEach(function (player) {
          if(playerId === player.playerId) {
            player.destroy();
          }
        });
      });

      this.socket.on('chamberSettingsUpdate', function (playerId) {
        console.log('Chamber settings updated');
      });

      this.socket.on('sendDebugBounds', function (collidingTiles) {
        drawDebug(collidingTiles);
      });

      this.socket.on('playerUpdates', function (players) {
        //console.log('players = ', players);
        Object.keys(players).forEach(function (id) {
          //console.log('otherPlayers = ', otherPlayers);
          self.players.getChildren().forEach(function (player) {
            // console.log('players[id].playerId = ', players[id].playerId);
            // console.log('player.playerId = ', player);
            if (players[id].playerId === player.playerId) {
              // Create a debug graphics object if it doesn't exist
              if (showDebug === true) {
                // console.log('showing debugging is true');
                console.log('players[id].debug.x = ', players[id].debug.x);
                console.log('players[id].debug.y = ', players[id].debug.y);
                console.log('players[id].debug.width = ', players[id].debug.width);
                console.log('players[id].debug.height = ', players[id].debug.height);
                debugGraphics = self.add.graphics();
                // Clear the previous frame's debug graphics
                debugGraphics.clear();
                // Draw the collision box for each player
                debugGraphics.lineStyle(10, 0xff0000);
                debugGraphics.strokeRect(players[id].debug.x, players[id].debug.y, players[id].debug.width, players[id].debug.height);
              }
              player.setPosition(players[id].position.x, players[id].position.y);
              player.depth = players[id].position.y-87;
              // console.log('self.container = ', player, '\n', 'player coordinates are: X= ', players[id].position.x, 'Y= ', players[id].position.y);
              //console.log(players[id].input);
              let direction =  null;
              let animationSuffix = null 
              if(players[id].isMoving === true) {
                // animationSuffix = direction;
              }
              if (players[id].rotation == 1 || players[id].input.left === true) {
                direction = 'Left';
                if (players[id].isMoving === true) {
                  animationSuffix = direction;
                  if (player.list[0].texture.key.includes('tail_')) {
                    // primary tail
                    player.bringToTop(player.list[0]);
                    // secondary tail
                    player.bringToTop(player.list[0]);
                    // accent tail
                    player.bringToTop(player.list[0]);
                    // head accessories
                    player.sendToBack(player.list[15]);
                  }
                } else {
                  animationSuffix = 'Stop' + direction;
                }
                player.list[0].play(players[id].headAccessories.sprite + animationSuffix, true);
                player.list[1].play(players[id].body.sprite + animationSuffix, true);
                player.list[2].play(players[id].body.secondarySprite + animationSuffix, true);
                player.list[3].play(players[id].body.accentSprite + animationSuffix, true);
                player.list[4].play(players[id].genitles.sprite + animationSuffix, true);
                player.list[5].play(players[id].hands.sprite + animationSuffix, true);
                player.list[6].play(players[id].feet.sprite + animationSuffix, true);

                player.list[7].play(players[id].head.sprite + animationSuffix, true);
                player.list[8].play(players[id].head.secondarySprite + animationSuffix, true);
                player.list[9].play(players[id].head.accentSprite + animationSuffix, true);
                player.list[10].play(players[id].beak.sprite + animationSuffix, true);

                player.list[11].play(players[id].eyes.outer + animationSuffix, true);
                player.list[12].play(players[id].eyes.iris + animationSuffix, true);
                player.list[13].play(players[id].hair.sprite + animationSuffix, true);
                player.list[14].play(players[id].ear.outerSprite + animationSuffix, true);
                player.list[15].play(players[id].ear.innerSprite + animationSuffix, true);

                player.list[16].play(players[id].tail.sprite + animationSuffix, true);
                player.list[17].play(players[id].tail.secondarySprite + animationSuffix, true);
                player.list[18].play(players[id].tail.accentSprite + animationSuffix, true);
              }
              if (players[id].rotation == 2 || players[id].input.right === true) {
                direction = 'Right';
                if (players[id].isMoving === true) {
                  animationSuffix = direction;
                  if (player.list[0].texture.key.includes('tail_')) {
                    // primary tail
                    player.bringToTop(player.list[0]);
                    // secondary tail
                    player.bringToTop(player.list[0]);
                    // accent tail
                    player.bringToTop(player.list[0]);
                    // head accessories
                    player.sendToBack(player.list[15]);
                  }
                } else {
                  animationSuffix = 'Stop' + direction;
                }
                player.list[0].play(players[id].headAccessories.sprite + animationSuffix, true);
                player.list[1].play(players[id].body.sprite + animationSuffix, true);
                player.list[2].play(players[id].body.secondarySprite + animationSuffix, true);
                player.list[3].play(players[id].body.accentSprite + animationSuffix, true);
                player.list[4].play(players[id].genitles.sprite + animationSuffix, true);
                player.list[5].play(players[id].hands.sprite + animationSuffix, true);
                player.list[6].play(players[id].feet.sprite + animationSuffix, true);

                player.list[7].play(players[id].head.sprite + animationSuffix, true);
                player.list[8].play(players[id].head.secondarySprite + animationSuffix, true);
                player.list[9].play(players[id].head.accentSprite + animationSuffix, true);
                player.list[10].play(players[id].beak.sprite + animationSuffix, true);

                player.list[11].play(players[id].eyes.outer + animationSuffix, true);
                player.list[12].play(players[id].eyes.iris + animationSuffix, true);
                player.list[13].play(players[id].hair.sprite + animationSuffix, true);
                player.list[14].play(players[id].ear.outerSprite + animationSuffix, true);
                player.list[15].play(players[id].ear.innerSprite + animationSuffix, true);

                player.list[16].play(players[id].tail.sprite + animationSuffix, true);
                player.list[17].play(players[id].tail.secondarySprite + animationSuffix, true);
                player.list[18].play(players[id].tail.accentSprite + animationSuffix, true);
              }
              if (players[id].rotation == 3 || players[id].input.up === true) {
                direction = 'Up';
                if (players[id].isMoving === true) {
                  animationSuffix = direction;
                  if (player.list[0].texture.key.includes('tail_')) {
                    // primary tail
                    player.bringToTop(player.list[0]);
                    // secondary tail
                    player.bringToTop(player.list[0]);
                    // accent tail
                    player.bringToTop(player.list[0]);
                    // head accessories
                    player.sendToBack(player.list[15]);
                  }
                  // for (let i = 0; i < player.list.length; i++) {
                  //   console.log('Up Texture Key player.list[',i,']= ', player.list[i].texture.key);
                  // }
                } else {
                  animationSuffix = 'Stop' + direction;
                }
                player.list[0].play(players[id].headAccessories.sprite + animationSuffix, true);
                player.list[1].play(players[id].body.sprite + animationSuffix, true);
                player.list[2].play(players[id].body.secondarySprite + animationSuffix, true);
                player.list[3].play(players[id].body.accentSprite + animationSuffix, true);
                player.list[4].play(players[id].genitles.sprite + animationSuffix, true);
                player.list[5].play(players[id].hands.sprite + animationSuffix, true);
                player.list[6].play(players[id].feet.sprite + animationSuffix, true);

                player.list[7].play(players[id].head.sprite + animationSuffix, true);
                player.list[8].play(players[id].head.secondarySprite + animationSuffix, true);
                player.list[9].play(players[id].head.accentSprite + animationSuffix, true);
                player.list[10].play(players[id].beak.sprite + animationSuffix, true);

                player.list[11].play(players[id].eyes.outer + animationSuffix, true);
                player.list[12].play(players[id].eyes.iris + animationSuffix, true);
                player.list[13].play(players[id].hair.sprite + animationSuffix, true);
                player.list[14].play(players[id].ear.outerSprite + animationSuffix, true);
                player.list[15].play(players[id].ear.innerSprite + animationSuffix, true);

                player.list[16].play(players[id].tail.sprite + animationSuffix, true);
                player.list[17].play(players[id].tail.secondarySprite + animationSuffix, true);
                player.list[18].play(players[id].tail.accentSprite + animationSuffix, true);
              }
              if (players[id].rotation == 4 || players[id].input.down === true) {
                direction = 'Down';
                if (players[id].isMoving === true) {
                  animationSuffix = direction;
                  if (!player.list[0].texture.key.includes('tail_')) {
                    // accent tail
                    player.sendToBack(player.list[18]);
                    // secondary tail
                    player.sendToBack(player.list[18]);
                    // primary tail
                    player.sendToBack(player.list[18]);
                    // head accessories
                    player.bringToTop(player.list[3]);
                  }
                } else {
                  animationSuffix = 'Stop' + direction;
                }
                player.list[0].play(players[id].tail.sprite + animationSuffix, true);
                player.list[1].play(players[id].tail.secondarySprite + animationSuffix, true);
                player.list[2].play(players[id].tail.accentSprite + animationSuffix, true);

                player.list[3].play(players[id].body.sprite + animationSuffix, true);
                player.list[4].play(players[id].body.secondarySprite + animationSuffix, true);
                player.list[5].play(players[id].body.accentSprite + animationSuffix, true);
                player.list[6].play(players[id].genitles.sprite + animationSuffix, true);
                player.list[7].play(players[id].hands.sprite + animationSuffix, true);
                player.list[8].play(players[id].feet.sprite + animationSuffix, true);

                player.list[9].play(players[id].head.sprite + animationSuffix, true);
                player.list[10].play(players[id].head.secondarySprite + animationSuffix, true);
                player.list[11].play(players[id].head.accentSprite + animationSuffix, true);
                player.list[12].play(players[id].beak.sprite + animationSuffix, true);

                player.list[13].play(players[id].eyes.outer + animationSuffix, true);
                player.list[14].play(players[id].eyes.iris + animationSuffix, true);
                player.list[15].play(players[id].hair.sprite + animationSuffix, true);
                player.list[16].play(players[id].ear.outerSprite + animationSuffix, true);
                player.list[17].play(players[id].ear.innerSprite + animationSuffix, true);
                player.list[18].play(players[id].headAccessories.sprite + animationSuffix, true);
              }

              
              
              // console.log(players[id].firstName, 'isMoving = ', players[id].isMoving);
            }
          });
        });
      });

      function rotationfunct(self, rotation) {
      
    }



      this.cursors = this.input.keyboard.createCursorKeys();
      this.leftKeyPressed = false;
      this.rightKeyPressed = false;
      this.upKeyPressed = false;
      this.downKeyPressed = false;


      //this is the code to determine wether the game or the chat is in focus
      let phaserApp = document.getElementById("phaserApp");
      phaserApp.onfocus = function () {
        chatFocused = false;
        releaseKeys(chatFocused);
        console.log('ChatFocused = ', chatFocused);
      }
      phaserApp.onblur = function () {
        //when you stop focusingon it
        chatFocused = true;
        // this.input.keyboard.disableGlobalCapture(); //why can I not use this.input.keyboard inside a function?????
        releaseKeys(chatFocused);
        console.log('ChatFocused = ', chatFocused);
      }

      function releaseKeys(focused){
        console.log('release keys called')
        if (focused == false) {
          self.input.keyboard.enabled = true;
          self.input.keyboard.enableGlobalCapture();
          console.log('in game arrow keys enabled');
        }
        else {
          self.input.keyboard.disableGlobalCapture();
          // this.input.keyboard.enabled = false;
          console.log('in game arrow keys disabled');
        }
      }

      //----- this detects if the game has been clicked so as to move the focus off of the chat div and back onto the game allowing players to move again -----//
      this.input.on('pointerdown', function (pointer) {
        document.getElementById('phaserApp').focus();
        //console.log('phaser game was clicked');
      }, this);




      function spawnSpells(spells) {
        var spell0 = self.add.image(spells[0].x, spells[0].y, spells[0].Icon).setInteractive();
        var spell1 = self.add.image(spells[1].x, spells[1].y, spells[1].Icon).setInteractive();
        var spell2 = self.add.image(spells[2].x, spells[2].y, spells[2].Icon).setInteractive();
        var spellInfo = {selection:'', Name:'', Descrip:'',locationX:'', locationY:''};
        spell0.on('pointerdown', function (pointer){
          toDestroy = spell0;
          if (pointer.rightButtonDown()) {
            spellInfo.Name = spells[0].Name;
            clicked = spells[0];
            console.log(spellInfo.Name, ' was Right clicked');
          } else {
            console.log('spell was Left clicked');
          }
        });
        spell1.on('pointerdown', function (pointer){
          toDestroy = spell1;
          if (pointer.rightButtonDown()) {
            spellInfo.Name = spells[1].Name;
            clicked = spells[1];
            console.log(spellInfo.Name, ' was Right clicked');
          } else {
            console.log('spell was Left clicked');
          }
        });
        spell2.on('pointerdown', function (pointer){
          toDestroy = spell2;
          if (pointer.rightButtonDown()) {
            spellInfo.Name = spells[2].Name;
            clicked = spells[2];
            console.log(spellInfo.Name, ' was Right clicked');
          } else {
            console.log('spell was Left clicked');
          }
        });
      }

      function callRightClickFunction(pointer, playerInfo) {
        var rightClickedList = [];
          if (pointer.rightButtonDown()) {
            clicked = playerInfo;
            console.log('clicked = ', clicked);
            console.log('playerInfo = ', playerInfo);
            var playerClicked = {
              Identifier: playerInfo.Identifier,
              playerId: playerInfo.playerId
            }
            rightClickedList.push(playerClicked)
          } else {
            console.log('sprite was Left clicked');
            console.log('playerInfo = ', playerInfo);
            console.log(pointer);
          }

          console.log('rightClickedList[0] = ', rightClickedList[0]);
          self.socket.emit('playerRightClicked', {
              rightClickedList
            })
      }

      this.socket.on('playerRightClickedResponse', function(info) {
        console.log('info = ', info);
        const contextMenu = document.getElementById('contextMenu');
        // console.log('contextMenu = ', contextMenu);
        const playerMenu = document.createElement('playerMenu');
        playerMenu.className = 'playerMenu';
        contextMenu.appendChild(playerMenu);

        const playerList = document.createElement('ul');
        playerMenu.appendChild(playerList);

        for (let i = 0; i < info.length; i++) {
          console.log('info[i] = ', info[i]);
          const playerLi = document.createElement('li');
          playerLi.innerHTML = info[i].name;
          playerList.appendChild(playerLi);

          const subMenu = document.createElement('subMenu');
          subMenu.className = 'subMenu';

          playerLi.appendChild(subMenu);

          const playerActionList = document.createElement('ul');
          playerLi.appendChild(playerActionList);

          const playerActionLi0 = document.createElement('li');
          playerActionList.appendChild(playerActionLi0);

          const examineButton = document.createElement('div');
          examineButton.setAttribute('id', 'examineItem');
          examineButton.innerHTML = 'Examine';

          examineButton.addEventListener('click', function(event) {
            event.preventDefault();
            console.log('clicked = ', clicked)
            self.socket.emit('examineClicked', clicked);
            console.log('clicked = ', clicked)
            //console.log('examineItem was clicked', '\n', 'Client Side clicked variable = ', clicked);
            clicked = {Identifier: ''};
            //console.log(playerInfo.username);
            //examineClicked(playerInfo);
            playerMenu.remove();
          })

          playerActionLi0.appendChild(examineButton);

          const playerActionLi1 = document.createElement('li');
          playerActionList.appendChild(playerActionLi1);

          if(info[i].heldBy == self.socket.id) {
            console.log('heldBy = ', info[i].heldBy);
            console.log('self.socketID = ', self.socket.id);
            const releaseInput = document.createElement('div');
            releaseInput.innerHTML = 'Release';

            releaseInput.setAttribute('id', 'release');
            releaseInput.addEventListener("click", function(event) {
              event.preventDefault();
              console.log('clicked = ', clicked);
              self.socket.emit('releaseClicked', clicked);
              clicked = {Identifier: ''};
            })
            playerActionLi1.appendChild(releaseInput);

            const playerActionLi2 = document.createElement('li');
            playerActionList.appendChild(playerActionLi2);

            const gripFirmly = document.createElement('div');
            gripFirmly.innerHTML = 'Grip Firmly';

            gripFirmly.setAttribute('id', 'gripFirmly');
            gripFirmly.addEventListener("click", function(event){
              event.preventDefault();
              console.log('clicked = ', clicked);
              self.socket.emit('gripFirmly', clicked);
              clicked = {Identifier: ''};
            })
            playerActionLi2.appendChild(gripFirmly);
            } else if(info[i].grippedBy == self.socket.id) {
              console.log('grippedBy = ', info[i].grippedBy);
              
              const voreInput = document.createElement('div');
              voreInput.innerHTML = 'Vore';
              voreInput.setAttribute('id', 'vore');
              playerActionLi2.appendChild(voreInput);

              const voreSubMenu = document.createElement('subMenu');
              subMenu.className = 'subMenu';

              playerActionLi2.appendChild(subMenu);

              const voreActionList = document.createElement('ul');
              voreSubMenu.appendChild(voreActionList);

              const voreActionLi0 = document.createElement('li');
              voreActionList.appendChild(voreActionLi0);

              const swallowInput = document.createElement('div');
              swallowInput.innerHTML = 'Swallow';



            } else if(info[i].grippedBy = null && info[i].heldBy == null) {
              const grabInput = document.createElement('div');
              grabInput.innerHTML = 'Grab';

              grabInput.setAttribute('id', 'grab');
              grabInput.addEventListener("click", function(event) {
                event.preventDefault();
                console.log('clicked = ', clicked);
                self.socket.emit('grabClicked', clicked);
                clicked = {Identifier: ''};
              });
              playerActionLi1.appendChild(grabInput);
            }
          


          const playerActionLi3 = document.createElement('li');
          playerActionList.appendChild(playerActionLi3);

          const voreOptions = document.createElement('div');
          voreOptions.innerHTML = 'Vore';

          const seperatorLi0 = document.createElement('li');
          seperatorLi0.setAttribute('class', 'seperator');
          playerActionList.appendChild(seperatorLi0);
        }
      });

      // var input = document.getElementById("examineItem");
      // input.addEventListener("click", function(event) {
      //   event.preventDefault();
      //   console.log('clicked = ', clicked)
      //   self.socket.emit('examineClicked', clicked);
      //   console.log('clicked = ', clicked)
      //   //console.log('examineItem was clicked', '\n', 'Client Side clicked variable = ', clicked);
      //   clicked = {Identifier: ''};
      //   //console.log(playerInfo.username);
      //   //examineClicked(playerInfo);
      // });

      this.socket.on('examinedInfo', function (examinedItem) {
        console.log('examintedItem information from server = ', examinedItem);
        const lookDisplay = document.getElementById("lookDisplay")
        if (examinedItem.Identifier === 'spell') {
          lookDisplay.innerHTML = '<strong>Spell Name: </strong>'+examinedItem.Name+'<br><br><strong>Spell Description:</strong><br>'+examinedItem.Description
        }
        if (examinedItem.Identifier === 'player') {
          console.log('examinedItem = ', examinedItem);
          lookDisplay.innerHTML = '<strong>Name: </strong>'+examinedItem.firstName + ' ' + examinedItem.lastName+'<br><br><strong>Player Description:</strong><br>'+examinedItem.icDescrip
        }
        document.getElementById("lookDisplay").style.display = "block";
        document.getElementById("itemsDisplay").style.display = "none";
        document.getElementById("spellsDisplay").style.display = "none";
        document.getElementById("mapDisplay").style.display = "none";
        document.getElementById("voreDisplay").style.display = "none";
        document.getElementById("optionsDisplay").style.display = "none";
        //console.log('sprite was Right clicked');
      });

      var pickUpInput = document.getElementById("pickUp");
      pickUpInput.addEventListener("click", function(event) {
        event.preventDefault();
        self.socket.emit('pickUpClicked', clicked);
        clicked = {Identifier: ''};
      });
      this.socket.on('pickedUpItem', function (spellInventory) {
        console.log('picking up a spell');
        //console.log(playerInfo.username);
        const spellsDisplay = document.getElementById("spellsDisplay")
        var spellsTable = document.getElementById("spellsTable");
        var row = spellsTable.insertRow();
        var cell1 = row.insertCell();
        var cell2 = row.insertCell();
        var cell3 = row.insertCell();
        cell1.innerHTML = '<img src="assets/images/Scroll_02.png" alt="Spell1">';
        cell2.innerHTML = spellInventory[spellInventory.length-1].Name;
        cell3.innerHTML = spellInventory[spellInventory.length-1].Description;
        document.getElementById("lookDisplay").style.display = "none";
        document.getElementById("itemsDisplay").style.display = "none";
        document.getElementById("spellsDisplay").style.display = "block";
        document.getElementById("mapDisplay").style.display = "none";
        document.getElementById("optionsDisplay").style.display = "none";
        //console.log('spell was Right clicked');
        toDestroy.destroy();
        toDestroy = null;
        //console.log('spell0 = ', spell0);
      })

      // var grabInput = document.getElementById("grab");
      // grabInput.addEventListener("click", function(event) {
      //   event.preventDefault();
      //   console.log('clicked = ', clicked);
      //   self.socket.emit('grabClicked', clicked);
      //   clicked = {Identifier: ''};
      // });

      this.socket.on('pickedUpItem', function (spellInventory) {
        console.log('picking up a spell');
        //console.log(playerInfo.username);
        const spellsDisplay = document.getElementById("spellsDisplay")
        var spellsTable = document.getElementById("spellsTable");
        var row = spellsTable.insertRow();
        var cell1 = row.insertCell();
        var cell2 = row.insertCell();
        var cell3 = row.insertCell();
        cell1.innerHTML = '<img src="assets/images/Scroll_02.png" alt="Spell1">';
        cell2.innerHTML = spellInventory[spellInventory.length-1].Name;
        cell3.innerHTML = spellInventory[spellInventory.length-1].Description;
        document.getElementById("lookDisplay").style.display = "none";
        document.getElementById("itemsDisplay").style.display = "none";
        document.getElementById("spellsDisplay").style.display = "block";
        document.getElementById("mapDisplay").style.display = "none";
        document.getElementById("optionsDisplay").style.display = "none";
        //console.log('spell was Right clicked');
        toDestroy.destroy();
        toDestroy = null;
        //console.log('spell0 = ', spell0);
      })














      //----- Chat box -----//
      rememberText();

        var element = function(id){
          return document.getElementById(id);
        }
        //Get Elements
        var messages = element('messages');
        var textarea = element('textarea');








        // (function(){
        console.log('weird ass function thingy called');
        rememberText();

        var element = function(id){
          return document.getElementById(id);
        }
        //Get Elements
        var messages = element('messages');
        var textarea = element('textarea');
        // var username = element('username');
        // var clearBtn = element('clearBtn');



        //----- Checking if socket is connected -----//
        if(this.socket !== undefined){
          console.log('Connected to Socket...');
          //----- Client is recieving message sent from server -----//
          this.socket.on('output', function(data){
            console.log('all chat messages = ', data);
            //----- Checking if there are any messages saved in history -----//
            if(data.length){
              // console.log('data has length');
              for(var x = 0;x < data.length;x++){
                // console.log('for loop happening');
                if(data[x].deleted.status == 'false'){
                  // console.log('data.deleted.status == false');
                  //----- Runs function to check wether chat history is scrolled all the way down to bottom -----//
                  const isScrolledToBottom = scrollChecker();

                  //----- Create div that will hold received message -----//
                  var message = document.createElement('div');
                  //----- set the div's id to match the mongo id set for this post stored in database -----//
                  message.id = data[x]._id;
                  //----- Apply ".chat-message" class to div for styling -----//
                  message.setAttribute('class', 'chat-message');

                  var msgTitleBar = document.createElement('div');
                  msgTitleBar.setAttribute('class', 'msg-title-bar');
                  message.appendChild(msgTitleBar);

                  //----- Create a span element that will hold the message sent time in chat history -----//
                  var timeSpan = document.createElement('div');
                  //----- Take full date and convert it to user's local time zone -----//
                  //----- Then summerize it to show only hour and minutes and insert as raw HTML in span -----//
                  timeSpan.innerHTML = new Date(Date.parse(data[x].message[data[x].message.length-1].time)).toLocaleTimeString([], {hour: '2-digit', minute: '2-digit'})+' ';
                  //----- Set ".postTime" class to this span to apply styling unique to timestamp -----//
                  timeSpan.className = 'postTime'
                  timeSpan.style.display = 'inline-block';
                  // timeSpan.style.cssFloat = "left";
                  //----- Insert timestamp as first item in the div that will hole the entire post -----//
                  msgTitleBar.appendChild(timeSpan);

                  //----- Create a span that will hold username assigned to sent message in chat history -----//
                  var userSpan = document.createElement('div');
                  //----- Insert username as raw HTML in span and make Bold -----//
                  userSpan.innerHTML = '<strong>'+data[x].name+': '+'</strong>';
                  userSpan.className = 'msgUsername'
                  userSpan.style.display = 'inline-block';
                  // userSpan.style.cssFloat = "left";
                  //----- Insert username as second item in the div that will hold the entire post -----//
                  msgTitleBar.appendChild(userSpan);

                  var spoilerSpan = document.createElement('div');
                  // spoilerSpan.style.display = 'inline-block';
                  // spoilerSpan.style.cssFloat = "left";
                  spoilerSpan.style.width = 'fit-content'
                  if(data[x].spoiler.status !== 'none'){
                    spoilerSpan.className = 'spoiled-'+data[x].spoiler.status+' hidden';
                  } else{
                    spoilerSpan.className = 'spoiled-'+data[x].spoiler.status;
                  }

                  spoilerSpan.onclick = function showHideSpoils(event){
                    console.log(event);
                    console.log(event.target.parentElement);
                    // ev.target.style.backgroundColor = '#191932'
                    event.target.parentElement.classList.toggle("hidden");
                    event.target.parentElement.classList.toggle("show");
                  };
                  message.appendChild(spoilerSpan);

                  if(data[x].spoiler.status == 'watersports' && document.querySelector("#watersportsBox").checked == false){
                    spoilerSpan.classList.toggle("hidden");
                    spoilerSpan.classList.toggle("show");
                  }
                  if(data[x].spoiler.status == 'disposal' && document.querySelector("#disposalBox").checked == false){
                    spoilerSpan.classList.toggle("hidden");
                    spoilerSpan.classList.toggle("show");
                  }
                  if(data[x].spoiler.status == 'gore' && document.querySelector("#goreBox").checked == false){
                    spoilerSpan.classList.toggle("hidden");
                    spoilerSpan.classList.toggle("show");
                  }

                  //----- Create a span that will hold actual message received from server to add to chat history -----//
                  var postSpan = document.createElement('div');
                  // postSpan.style.display = 'inline-block';
                  // postSpan.style.cssFloat = "left";
                  // console.log(data[x].message[data[x].message.length-1].content);
                  //----- Insert post text as raw HTML in the span -----//
                  postSpan.innerHTML = data[x].message[data[x].message.length-1].content;
                  //----- Insert message as 3rd item in the div that will hold the entire post -----//
                  spoilerSpan.appendChild(postSpan);
                  console.log(postSpan);


                  var editSpan = document.createElement('div');
                  // editSpan.innerHTML = 'Edit';
                  editSpan.className = 'editPost dropdown'
                  editSpan.setAttribute('data-dropdown', '');

                  var settingsBtn = document.createElement('button');
                  settingsBtn.innerHTML = '&#xe5d4;'
                  settingsBtn.className = 'link msg-control-btn material-icons md-18'
                  settingsBtn.id = data[x].identifier;
                  settingsBtn.setAttribute('data-dropdown-button', '')
                  editSpan.appendChild(settingsBtn);






                  settingsBtn.onclick = function(e){
                    console.log('Edit button element = ', e);
                    console.log('e.clientX = ', e.clientX, '\n', 'e.clientY = ', e.clientY)
                    console.log('post ID = ', e.target.parentElement.parentElement.parentElement.id);
                    console.log('message content = ', e.target.parentElement.parentElement.nextElementSibling.firstChild);
                    console.log('spoiler class = ', e.target.parentElement.parentElement.nextElementSibling.classList);
                    console.log('e.id = ', e.srcElement.id);
                    console.log('id in address bar = ', document.location.href.split('play/')[1]);


                    var messageId = e.target.parentElement.parentElement.parentElement.id;
                    var messageContent = e.target.parentElement.parentElement.nextElementSibling.firstChild;
                    var spoilerStatus = e.target.parentElement.parentElement.nextElementSibling.classList;
                    var btnLoc = {
                      x: e.clientX,
                      y: e.clientY
                    }

                    var container = document.getElementsByClassName('container');
                    console.log('container = ', container);

                    var dropDwnMnu = document.createElement('div');
                    dropDwnMnu.style.top = btnLoc.y+'px'
                    dropDwnMnu.style.left = btnLoc.x+'px'
                    dropDwnMnu.style.transform = 'translateX(-110%)'
                    dropDwnMnu.className = 'msg-settings-menu'
                    dropDwnMnu.tabIndex = 0;
                    dropDwnMnu.focus();



                    container[0].appendChild(dropDwnMnu);
                    dropDwnMnu.style.overflow = 'hidden';
                    setTimeout(function(){
                      console.log("Executed after 151 milliseconds");
                      dropDwnMnu.style.overflow = 'visible';
                    }, 550);


                    var extraDiv = document.createElement('div');
                    dropDwnMnu.appendChild(extraDiv)

                    if(e.srcElement.id == document.location.href.split('play/')[1]){
                      console.log('you have found a message crafted by yourself!');
                      var dropDwnEdit = document.createElement('div');
                      dropDwnEdit.innerHTML = 'Edit';
                      dropDwnEdit.className = 'msg-settings-option';
                      extraDiv.appendChild(dropDwnEdit);

                      var dropDwnDelete = document.createElement('div');
                      dropDwnDelete.innerHTML = 'Delete';
                      dropDwnDelete.className = 'msg-settings-option';
                      extraDiv.appendChild(dropDwnDelete);

                      var dropDwnSpoil = document.createElement('div');
                      dropDwnSpoil.innerHTML = 'Edit Spoiler';
                      dropDwnSpoil.style.position = 'relative'
                      dropDwnSpoil.className = 'msg-settings-option edit-expander';
                      extraDiv.appendChild(dropDwnSpoil);
                      dropDwnMnu.focus();
                      dropDwnMnu.style.height = 'fit-content'

                      var spoilerOptionsContainer = document.createElement('div');

                      spoilerOptionsContainer.className = 'spoilerOptionsContainer';

                      dropDwnSpoil.appendChild(spoilerOptionsContainer);

                      var spoilerList = document.createElement('ul');
                      spoilerOptionsContainer.appendChild(spoilerList);
                      spoilerList.style.listStyleType = 'none'
                      spoilerList.style.margin = '0'
                      spoilerList.style.padding = '0'

                      var spoilerLi01 = document.createElement('li')
                      spoilerList.appendChild(spoilerLi01);
                      var radioSelect01 = document.createElement('input');
                      radioSelect01.type = 'radio';
                      radioSelect01.id = 'spoileEdit-general'
                      radioSelect01.name = 'spoilerEdit'
                      radioSelect01.value = 'general'
                      spoilerLi01.appendChild(radioSelect01);
                      var radioSelect01Label = document.createElement('label');
                      radioSelect01Label.for = 'spoileEdit-general'
                      radioSelect01Label.innerHTML = 'General';
                      spoilerLi01.appendChild(radioSelect01Label);
                      if(spoilerStatus.contains('spoiled-general')){
                        radioSelect01.checked = true;
                      }
                      radioSelect01.onclick = function(){
                        console.log('clicked the general spoil edit button');
                        spoilEdited(messageId, radioSelect01.value);
                      }

                      var spoilerLi02 = document.createElement('li')
                      spoilerList.appendChild(spoilerLi02);
                      var radioSelect02 = document.createElement('input');
                      radioSelect02.type = 'radio';
                      radioSelect02.id = 'spoileEdit-watersports'
                      radioSelect02.name = 'spoilerEdit'
                      radioSelect02.value = 'watersports'
                      spoilerLi02.appendChild(radioSelect02);
                      var radioSelect02Label = document.createElement('label');
                      radioSelect02Label.for = 'spoileEdit-watersports'
                      radioSelect02Label.innerHTML = 'Watersports';
                      spoilerLi02.appendChild(radioSelect02Label);
                      if(spoilerStatus.contains('spoiled-watersports')){
                        radioSelect02.checked = true;
                      }
                      radioSelect02.onclick = function(){
                        console.log('clicked the watersports spoil edit button');
                        console.log('messageId at onclick = ', messageId);
                        spoilEdited(messageId, radioSelect02.value);
                      }

                      var spoilerLi03 = document.createElement('li')
                      spoilerList.appendChild(spoilerLi03);
                      var radioSelect03 = document.createElement('input');
                      radioSelect03.type = 'radio';
                      radioSelect03.id = 'spoileEdit-disposal'
                      radioSelect03.name = 'spoilerEdit'
                      radioSelect03.value = 'disposal'
                      spoilerLi03.appendChild(radioSelect03);
                      var radioSelect03Label = document.createElement('label');
                      radioSelect03Label.for = 'spoileEdit-disposal'
                      radioSelect03Label.innerHTML = 'Scat/Disposal';
                      spoilerLi03.appendChild(radioSelect03Label);
                      if(spoilerStatus.contains('spoiled-disposal')){
                        radioSelect03.checked = true;
                      }
                      radioSelect03.onclick = function(){
                        console.log('clicked the disposal spoil edit button');
                        spoilEdited(messageId, radioSelect03.value);
                      }

                      var spoilerLi04 = document.createElement('li')
                      spoilerList.appendChild(spoilerLi04);
                      var radioSelect04 = document.createElement('input');
                      radioSelect04.type = 'radio';
                      radioSelect04.id = 'spoileEdit-gore'
                      radioSelect04.name = 'spoilerEdit'
                      radioSelect04.value = 'gore'
                      spoilerLi04.appendChild(radioSelect04);
                      var radioSelect04Label = document.createElement('label');
                      radioSelect04Label.for = 'spoileEdit-gore'
                      radioSelect04Label.innerHTML = 'Gore';
                      spoilerLi04.appendChild(radioSelect04Label);
                      if(spoilerStatus.contains('spoiled-gore')){
                        radioSelect04.checked = true;
                      }
                      radioSelect04.onclick = function(){
                        console.log('clicked the gore spoil edit button');
                        spoilEdited(messageId, radioSelect04.value);
                      }

                      var spoilerLi05 = document.createElement('li')
                      spoilerList.appendChild(spoilerLi05);
                      var radioSelect05 = document.createElement('input');
                      radioSelect05.type = 'radio';
                      radioSelect05.id = 'spoileEdit-none'
                      radioSelect05.name = 'spoilerEdit'
                      radioSelect05.value = 'none'
                      spoilerLi05.appendChild(radioSelect05);
                      var radioSelect05Label = document.createElement('label');
                      radioSelect05Label.for = 'spoileEdit-none'
                      radioSelect05Label.innerHTML = 'None';
                      spoilerLi05.appendChild(radioSelect05Label);
                      if(!spoilerStatus.contains('spoiled-general') && !spoilerStatus.contains('spoiled-watersports') && !spoilerStatus.contains('spoiled-disposal') && !spoilerStatus.contains('spoiled-gore')){
                        radioSelect05.checked = true;
                      }
                      radioSelect05.onclick = function(){
                        console.log('clicked the none spoil edit button');
                        spoilEdited(messageId, radioSelect05.value);
                      }


                      dropDwnEdit.onclick = function() {
                        console.log('onclick function messageContent', messageContent);
                        editBtnClicked(messageId, messageContent);
                      }

                      dropDwnDelete.onclick = function() {
                        deleteBtnClicked(messageId);
                      }
                    }else{
                      console.log('this message was not crafted by you...');
                      var dropDwnSpoil = document.createElement('div');
                      dropDwnSpoil.innerHTML = 'Edit Spoiler';
                      dropDwnSpoil.style.position = 'relative'
                      dropDwnSpoil.className = 'msg-settings-option edit-expander';
                      extraDiv.appendChild(dropDwnSpoil);
                      dropDwnMnu.focus();
                      dropDwnMnu.style.height = 'fit-content'

                      var spoilerOptionsContainer = document.createElement('div');

                      spoilerOptionsContainer.className = 'spoilerOptionsContainer';

                      dropDwnSpoil.appendChild(spoilerOptionsContainer);

                      var spoilerList = document.createElement('ul');
                      spoilerOptionsContainer.appendChild(spoilerList);
                      spoilerList.style.listStyleType = 'none'
                      spoilerList.style.margin = '0'
                      spoilerList.style.padding = '0'

                      var spoilerLi01 = document.createElement('li')
                      spoilerList.appendChild(spoilerLi01);
                      var radioSelect01 = document.createElement('input');
                      radioSelect01.type = 'radio';
                      radioSelect01.id = 'spoileEdit-general'
                      radioSelect01.name = 'spoilerEdit'
                      radioSelect01.value = 'general'
                      spoilerLi01.appendChild(radioSelect01);
                      var radioSelect01Label = document.createElement('label');
                      radioSelect01Label.for = 'spoileEdit-general'
                      radioSelect01Label.innerHTML = 'General';
                      spoilerLi01.appendChild(radioSelect01Label);
                      if(spoilerStatus.contains('spoiled-general')){
                        radioSelect01.checked = true;
                      }
                      radioSelect01.onclick = function(){
                        console.log('clicked the general spoil edit button');
                        spoilEdited(messageId, radioSelect01.value);
                      }

                      var spoilerLi02 = document.createElement('li')
                      spoilerList.appendChild(spoilerLi02);
                      var radioSelect02 = document.createElement('input');
                      radioSelect02.type = 'radio';
                      radioSelect02.id = 'spoileEdit-watersports'
                      radioSelect02.name = 'spoilerEdit'
                      radioSelect02.value = 'watersports'
                      spoilerLi02.appendChild(radioSelect02);
                      var radioSelect02Label = document.createElement('label');
                      radioSelect02Label.for = 'spoileEdit-watersports'
                      radioSelect02Label.innerHTML = 'Watersports';
                      spoilerLi02.appendChild(radioSelect02Label);
                      if(spoilerStatus.contains('spoiled-watersports')){
                        radioSelect02.checked = true;
                      }
                      radioSelect02.onclick = function(){
                        console.log('clicked the watersports spoil edit button');
                        console.log('messageId at onclick = ', messageId);
                        spoilEdited(messageId, radioSelect02.value);
                      }

                      var spoilerLi03 = document.createElement('li')
                      spoilerList.appendChild(spoilerLi03);
                      var radioSelect03 = document.createElement('input');
                      radioSelect03.type = 'radio';
                      radioSelect03.id = 'spoileEdit-disposal'
                      radioSelect03.name = 'spoilerEdit'
                      radioSelect03.value = 'disposal'
                      spoilerLi03.appendChild(radioSelect03);
                      var radioSelect03Label = document.createElement('label');
                      radioSelect03Label.for = 'spoileEdit-disposal'
                      radioSelect03Label.innerHTML = 'Scat/Disposal';
                      spoilerLi03.appendChild(radioSelect03Label);
                      if(spoilerStatus.contains('spoiled-disposal')){
                        radioSelect03.checked = true;
                      }
                      radioSelect03.onclick = function(){
                        console.log('clicked the disposal spoil edit button');
                        spoilEdited(messageId, radioSelect03.value);
                      }

                      var spoilerLi04 = document.createElement('li')
                      spoilerList.appendChild(spoilerLi04);
                      var radioSelect04 = document.createElement('input');
                      radioSelect04.type = 'radio';
                      radioSelect04.id = 'spoileEdit-gore'
                      radioSelect04.name = 'spoilerEdit'
                      radioSelect04.value = 'gore'
                      spoilerLi04.appendChild(radioSelect04);
                      var radioSelect04Label = document.createElement('label');
                      radioSelect04Label.for = 'spoileEdit-gore'
                      radioSelect04Label.innerHTML = 'Gore';
                      spoilerLi04.appendChild(radioSelect04Label);
                      if(spoilerStatus.contains('spoiled-gore')){
                        radioSelect04.checked = true;
                      }
                      radioSelect04.onclick = function(){
                        console.log('clicked the gore spoil edit button');
                        spoilEdited(messageId, radioSelect04.value);
                      }

                      var spoilerLi05 = document.createElement('li')
                      spoilerList.appendChild(spoilerLi05);
                      var radioSelect05 = document.createElement('input');
                      radioSelect05.type = 'radio';
                      radioSelect05.id = 'spoileEdit-none'
                      radioSelect05.name = 'spoilerEdit'
                      radioSelect05.value = 'none'
                      spoilerLi05.appendChild(radioSelect05);
                      var radioSelect05Label = document.createElement('label');
                      radioSelect05Label.for = 'spoileEdit-none'
                      radioSelect05Label.innerHTML = 'None';
                      spoilerLi05.appendChild(radioSelect05Label);
                      if(!spoilerStatus.contains('spoiled-general') && !spoilerStatus.contains('spoiled-watersports') && !spoilerStatus.contains('spoiled-disposal') && !spoilerStatus.contains('spoiled-gore')){
                        radioSelect05.checked = true;
                      }
                      radioSelect05.onclick = function(){
                        console.log('clicked the none spoil edit button');
                        spoilEdited(messageId, radioSelect05.value);
                      }
                    }



                    dropDwnMnu.onblur = function(){
                      const dropDwnMnuBlur = true;
                      console.log('activeElement = ', document.activeElement.tagName);
                      if (document.activeElement == spoilerOptionsContainer || document.activeElement == spoilerLi01|| document.activeElement == radioSelect01 || document.activeElement == radioSelect05Label){
                        console.log('menu thingy is in focus')
                      } else{
                        // dropDwnMnu.style.height = '0px'
                        // dropDwnMnu.style.overflow = 'hidden';
                        // 151 millisecond delay
                        setTimeout(function(){
                          console.log("Executed after 151 milliseconds");
                          dropDwnMnu.remove();
                          console.log('settings drop down menu no longer in focus');
                        }, 550);
                      };
                    }
                  }





                  msgTitleBar.appendChild(editSpan);

                  //----- Attach whole post div to the end of message history -----//
                  messages.appendChild(message);
                  console.log('messages div thingy = ', messages);

                  spoilerSpan.style.marginLeft = timeSpan.offsetWidth+'px';
                  //----- Once the above code has run, the message will have been successfully added to chat history -----//

                  //----- After the new message has been added to chat history, the below code will check -----//
                  //----- to see if latest message is currently visible. If user is scrolled too far up -----//
                  //----- they will not see latest message. The below code will insert a "New messages" -----//
                  //----- label above the messages that were not in view port when they were added to chat history -----//
                  var bounding = message.getBoundingClientRect();
                  if (bounding.top >= 0 && bounding.left >= 0 && bounding.right <= window.innerWidth && bounding.bottom <= window.innerHeight) {
                    //----- This runs if the most recent message is visible when added to chat history -----//
                    // console.log('Most recent post is in the viewport!');
                  } else {
                    //----- This runs if user is scrolled up and unable to see most recentl added message -----//
                    // console.log('Most recent post is NOT in the viewport!');
                    //----- Search for "new message" marker to see if it already exists in chat history -----//
                    var newMessageChecker = document.getElementsByClassName('newMessages');
                    if (newMessageChecker.length > 0) {
                      //----- This runs if a new messages marker was found in the chat history -----//
                        // console.log('new message marker already exists')
                    } else{
                      //----- This runs if no new messages marker was found in chat history -----//
                      //----- Creates div that will hold "New Messages" marker -----//
                      var newMessages = document.createElement('div');
                      //----- Inserts raw HTML containing "New Messages" text -----//
                      newMessages.innerHTML = '----- New Messages -----'
                      //----- Sets color of new messages marker to red in chat history -----//
                      newMessages.color = 'red';
                      //----- Assigns a class of ".newMessages" to div for styling -----//
                      newMessages.className = 'newMessages';
                      //----- Finds the last message that was added to chat history -----//
                      //----- And insterts "new messages" marker BEFORE the message that was last added -----//
                      message.previousSibling.appendChild(newMessages);
                    }
                  }

                  // console.log('post time = ', new Date(Date.parse(data[x].message[data[x].message.length-1].time)).toLocaleTimeString([], {hour: '2-digit', minute: '2-digit'}));

                  // new Date(Date.parse(data[x].message[data[x].message.length-1].time)).toLocaleTimeString([], {hour: '2-digit', minute: '2-digit'})+' ';
                  //----- Calls a function to check if user is scrolled all the way down to bottom -----//
                  //----- If user is scrolled to bottom, this will automatically scroll the chat history down further -----//
                  //----- This ensures that new messages are always in view and the user does not have to manually scroll down -----//
                  //----- each time a new message is added to the chat history -----//
                  if (isScrolledToBottom) {
                    messages.scrollTop = messages.scrollHeight - messages.clientHeight;
                  }
                }
              }
            }
          });

          this.socket.on('editOutput', function(data){
            console.log('editOutput = ', data);
            console.log('data.id = ', data._id);
            if(data.deleted.status == 'false'){
              const editedMsg = document.getElementById(data._id).firstChild.nextElementSibling.firstChild.innerHTML = data.message[data.message.length-1].content;
              console.log('document.getElementById(data._id) = ', document.getElementById(data._id));
              console.log('editedMsg', editedMsg);
            } else{
              const deletedMsg = document.getElementById(data._id);
              deletedMsg.remove();
            }
          })

          this.socket.on('editSpoilerOutput', function(data){
            console.log('editSpoilerOutput = ', data);
            console.log('data.id = ', data._id);
            var currentClass = document.getElementById(data._id).firstChild.nextElementSibling.classList[0];
            if(currentClass){
              const editedSpolier = document.getElementById(data._id).firstChild.nextElementSibling.classList.replace(currentClass,'spoiled-'+data.spoiler.status);
              document.getElementById(data._id).firstChild.nextElementSibling.classList.add('hidden');
            }else{
              document.getElementById(data._id).firstChild.nextElementSibling.classList.add('spoiled-'+data.spoiler.status);
              document.getElementById(data._id).firstChild.nextElementSibling.classList.add('hidden');
            }
          })

          this.socket.on('tooManyChars', function(data, message){
            textarea.innerHTML = message;
            charCounter();
            tooManyChars(data);
          });



        //----- Controls how and when messages are sent from message box -----//
          // console.log('charCount = ', charCount)
          textarea.addEventListener('keydown', function(event){
            // console.log('keydown detected');
            // console.log('event.key = ', event.key);

            if(event.which === 13 && event.shiftKey == false){
              var charCount = charCounter();
              event.preventDefault()
              console.log('charCount = ', charCount)
              if(charCount <= 10000){
                // Emit to server input
                console.log('sending message...');
                console.log(document.getElementById('spoilers').value);
                console.log(document.cookie.replace('TastyTails=',''));
                console.log(document.location.href.split('play/')[1]);
                self.socket.emit('input', {
                  name:localPlayerInfo.firstName+' '+localPlayerInfo.lastName,
                  message:textarea.innerHTML,
                  spoiler: document.getElementById('spoilers').value,
                  token: document.cookie.replace('TastyTails=',''),
                  charId: document.location.href.split('play/')[1]
                });
                localStorage.setItem('previousMessage', textarea.innerHTML);
                textarea.innerHTML = '';
                charCount = 0;
                charCounter();
              }else{
                console.log('too many characters, could not send message');
                tooManyChars(charCount);
              }
              // event.preventDefault();
            }

            if(event.which === 38 && textarea.innerHTML === ''){
              textarea.innerHTML = localStorage.getItem("previousMessage");
              charCounter();
              document.getElementById('textarea').focus();
            }

            if (event.ctrlKey && event.key === 'b'){
              console.log('ctrl b pressed');
              event.preventDefault()
              document.execCommand('bold');
            }
            if (event.ctrlKey && event.key === 'i'){
              console.log('ctrl i pressed');
              event.preventDefault()
              document.execCommand('italic');
            }
            if (event.ctrlKey && event.key === 'u'){
              console.log('ctrl u pressed');
              event.preventDefault()
              document.execCommand('underline');
            }
            if (event.ctrlKey && event.key === 's'){
              console.log('ctrl s pressed');
              event.preventDefault()
              document.execCommand('strikethrough');
            }
            if (event.ctrlKey && event.key === '-'){
              console.log('ctrl - pressed');
              event.preventDefault()
              document.execCommand('subscript');
            }
            if (event.ctrlKey && event.key === '+'){
              console.log('ctrl + pressed');
              event.preventDefault()
              document.execCommand('superscript');
            }
          })

          //----- Controls Character Limits -----//
          textarea.addEventListener('input', function(event){
            var tempText = textarea.innerHTML;
            localStorage.setItem("textarea", tempText);

            charCounter();
          })

          //----- Edit Button Functions -----//
          function editBtnClicked(messageId, messageContent){
            console.log('editBtn messageContent = ', messageContent);
            console.log('messageContent = ', messageContent.innerHTML);
            console.log('editbtnclicked: ', messageContent.parentElement.classList.contains('hidden'));
            const oldMessage = messageContent.innerHTML;
            var urlRegex = /((?:(http|https|Http|Https|rtsp|Rtsp):\/\/(?:(?:[a-zA-Z0-9\$\-\_\.\+\!\*\'\(\)\,\;\?\&\=]|(?:\%[a-fA-F0-9]{2})){1,64}(?:\:(?:[a-zA-Z0-9\$\-\_\.\+\!\*\'\(\)\,\;\?\&\=]|(?:\%[a-fA-F0-9]{2})){1,25})?\@)?)?((?:(?:[a-zA-Z0-9][a-zA-Z0-9\-]{0,64}\.)+(?:(?:aero|arpa|asia|a[cdefgilmnoqrstuwxz])|(?:biz|b[abdefghijmnorstvwyz])|(?:cat|com|coop|c[acdfghiklmnoruvxyz])|d[ejkmoz]|(?:edu|e[cegrstu])|f[ijkmor]|(?:gov|g[abdefghilmnpqrstuwy])|h[kmnrtu]|(?:info|int|i[delmnoqrst])|(?:jobs|j[emop])|k[eghimnrwyz]|l[abcikrstuvy]|(?:mil|mobi|museum|m[acdghklmnopqrstuvwxyz])|(?:name|net|n[acefgilopruz])|(?:org|om)|(?:pro|p[aefghklmnrstwy])|qa|r[eouw]|s[abcdeghijklmnortuvyz]|(?:tel|travel|t[cdfghjklmnoprtvwz])|u[agkmsyz]|v[aceginu]|w[fs]|y[etu]|z[amw]))|(?:(?:25[0-5]|2[0-4][0-9]|[0-1][0-9]{2}|[1-9][0-9]|[1-9])\.(?:25[0-5]|2[0-4][0-9]|[0-1][0-9]{2}|[1-9][0-9]|[1-9]|0)\.(?:25[0-5]|2[0-4][0-9]|[0-1][0-9]{2}|[1-9][0-9]|[1-9]|0)\.(?:25[0-5]|2[0-4][0-9]|[0-1][0-9]{2}|[1-9][0-9]|[0-9])))(?:\:\d{1,5})?)(\/(?:(?:[a-zA-Z0-9\;\/\?\:\@\&\=\#\~\-\.\+\!\*\'\(\)\,\_])|(?:\%[a-fA-F0-9]{2}))*)?(?:\b|$)+/gi;



            var links = messageContent.innerText.match(urlRegex, function(url) {
              console.log('url inserted into a href = ', url);

              return url;
            });
            console.log('links = ', links);
            if(links){
              for (let i = 0; i < links.length; i++) {
                // console.log('links[i] = ', links[i]);
                //const ahrefCheck = /(<a href=")(\/\/)?(${links[i]})(" target="_blank">)(${links[i]})(<\/a>)/gi
                const ahrefCheck = new RegExp('(<a href=")(\/\/)?' + links[i] + '(" target="_blank">)' + links[i] + '(<\/a>)', "g");
                if(ahrefCheck.test(messageContent.innerHTML)){
                  console.log('found a link');
                  console.log('links[i] = ', links[i]);
                  messageContent.innerHTML = messageContent.innerHTML.replace(ahrefCheck, links[i])
                } else{
                  console.log('Did not find a link');
                }
              }
            }





            const spoilerContainer = document.getElementById(messageId).firstChild.nextElementSibling;
            spoilerContainer.style.width = 'auto';

            messageContent.contentEditable = 'true';
            messageContent.classList.add('editing');
            if(messageContent.parentElement.classList.contains('hidden')){
              messageContent.parentElement.classList.remove('hidden');
              messageContent.parentElement.classList.add('show');
              messageContent.parentElement.style.pointerEvents = 'none';
            }
            if(messageContent.parentElement.classList.contains('show')){
              messageContent.parentElement.style.pointerEvents = 'none';
            }

            var cancel = document.createElement('span');
            cancel.innerHTML = 'Cancel';
            cancel.style.display = 'block';
            cancel.style.paddingLeft = '100px';
            cancel.addEventListener('click', () => {
              console.log('Cancelled Edit with Cancel button')
              messageContent.innerHTML = oldMessage;
              messageContent.contentEditable = 'false';
              messageContent.classList.remove('editing');
              messageContent.parentElement.style.pointerEvents = 'auto';
              spoilerContainer.style.width = 'fit-content';
              cancel.remove();
            });

            messageContent.parentElement.parentElement.appendChild(cancel);


            messageContent.addEventListener('keydown', keyDownHandeler)

            function keyDownHandeler(event){
              console.log('testing to see if this thingy works')
              if(event.which === 13 && event.shiftKey == false){
                // Emit to server input
                console.log('sending EDITED message...');
                self.socket.emit('inputEdit', {
                  _id:messageId,
                  message:messageContent.innerHTML,
                  token: document.cookie.replace('TastyTails=',''),
                  charId: document.location.href.split('play/')[1]
                });
                messageContent.contentEditable = 'false';
                messageContent.classList.remove('editing');
                messageContent.parentElement.style.pointerEvents = 'auto';
                spoilerContainer.style.width = 'fit-content';
                cancel.remove();
                messageContent.removeEventListener('keydown', keyDownHandeler);
              }
              if(event.which === 27){
                console.log('Cancelled Edit with Escape Key');
                messageContent.innerHTML = oldMessage;
                messageContent.contentEditable = 'false';
                messageContent.classList.remove('editing');
                messageContent.parentElement.style.pointerEvents = 'auto';
                spoilerContainer.style.width = 'fit-content';
                cancel.remove();
                messageContent.removeEventListener('keydown', keyDownHandeler);
              }
            };
          }

          function deleteBtnClicked(messageId, messageContent){
            console.log('too many chars function called');
            var deleteDialogue = document.createElement('div');
            deleteDialogue.className = 'dialogueBox';
            document.getElementsByClassName('chat-holder')[0].appendChild(deleteDialogue);

            var deleteTitle = document.createElement('h2');
            // notificationCounterDiv.innerHTML = `${charCount}/10000 Characters`;
            deleteTitle.innerHTML = `Delete This Message?`;
            deleteDialogue.appendChild(deleteTitle);

            var deleteMessageDiv = document.createElement('div');
            deleteMessageDiv.innerHTML = 'This action can not be undone.'
            deleteDialogue.appendChild(deleteMessageDiv);

            var cancelBtn = document.createElement('button')
            cancelBtn.innerHTML = 'Cancel';
            deleteDialogue.appendChild(cancelBtn);

            cancelBtn.addEventListener('click', () => {
              console.log('cancel button click');
              deleteDialogue.remove();
              document.getElementById('textarea').focus();
            })

            var deleteBtn = document.createElement('button')
            deleteBtn.innerHTML = 'Delete';
            deleteDialogue.appendChild(deleteBtn);

            deleteBtn.addEventListener('click', () => {
              console.log('dismiss button click');
              console.log('messageId = ', messageId);
              const deletedMsg = document.getElementById(messageId);
              console.log('deletedMsg = ', deletedMsg);
              // deletedMsg.remove();
              self.socket.emit('deleteMessage', {
                _id:messageId,
                token: document.cookie.replace('TastyTails=',''),
                charId: document.location.href.split('play/')[1]
              });
              deleteDialogue.remove();
              document.getElementById('textarea').focus();
            })
          }

          function spoilEdited(messageId, spoiler){
            console.log('spoilEdited function called successfully');
            console.log('messageId = ', messageId);
            console.log('spoiler = ', spoiler);
            self.socket.emit('sendSpoilEdit', {
              _id:messageId,
              spoiler:spoiler,
              token: document.cookie.replace('TastyTails=',''),
              charId: document.location.href.split('play/')[1]
            });
            console.log('sendSpoilEdit emitted');
          }

          //----- Handles socket events fired when pressing the "clear" button -----//
          // clearBtn.addEventListener('click', function(){
          //   self.socket.emit('clear');
          // });
          //----- After clear button is pressed and messages are removed from mongo -----//
          //----- This clears local chat history upon receiving confirmation from socket -----//
          this.socket.on('cleared', function(){

          });

        } else{
          console.log('socket not connecting...');
        }
      // })();

        function rememberText(){
        var storedText = localStorage.getItem("textarea");
        if(storedText != null){
          document.getElementById("textarea").innerHTML = storedText;
          charCounter();
          document.getElementById('textarea').focus();
        } else{
          document.getElementById("textarea").innerHTML = '';
          charCounter();
        }
      }

      function scrollChecker (){
        const atBottom = messages.scrollHeight - messages.clientHeight <= messages.scrollTop + 1;
        // console.log(atBottom);
        return atBottom;
      }


      document.getElementById('messages').addEventListener('scroll', checkIfScrolling);
      function checkIfScrolling(){
        const ifAtBottom = scrollChecker()
        if(ifAtBottom){
          var newMessageChecker = document.getElementsByClassName('newMessages');
          if (newMessageChecker.length > 0) {
              newMessageChecker[0].remove();
          }
        }
      }

      function charCounter(){
        charCount = document.getElementById('textarea').innerText.length;
        // console.log('charCount = ', charCount);
        const charCounter = document.getElementsByClassName('charlimit')[0];
        charCounter.innerText = `${charCount}/10000`;
        if(charCount > 9950){
          // console.log('(too much) charCount = ', charCount);
          const color = '#c94747';
          charCounter.style.color = color;
        } else{
          // console.log(' (too smol) charCount = ', charCount);
          const color = '#767f66'
          charCounter.style.color = color;
        }
        return charCount;
      }

      function tooManyChars(charCount){
        console.log('too many chars function called');
        var tooManyCharsDiv = document.createElement('div');
        tooManyCharsDiv.className = 'dialogueBox';
        document.getElementsByClassName('chat-holder')[0].appendChild(tooManyCharsDiv);

        console.log('charCount = ', charCount)
        var charCountDiv = document.createElement('h2');
        charCountDiv.innerHTML = charCount;
        charCountDiv.style.color = '#c94747';
        // charCountDiv.style.display = 'inline-block';
        tooManyCharsDiv.appendChild(charCountDiv);

        var notificationCounterDiv = document.createElement('h2');
        // notificationCounterDiv.innerHTML = `${charCount}/10000 Characters`;
        notificationCounterDiv.innerHTML = `/10000 Characters`;
        // notificationCounterDiv.display = 'inline-block';
        tooManyCharsDiv.appendChild(notificationCounterDiv);

        // document.styleSheets[0].addRule('.dialogueBox h2:before','content: "'+charCount+'";','color: red;');
        // document.styleSheets[0].addRule('.dialogueBox h2:before','color: #c94747;');

        var notificationMessageDiv = document.createElement('div');
        notificationMessageDiv.innerHTML = 'Your post has too many characters, try making your post shorter before sending.'
        tooManyCharsDiv.appendChild(notificationMessageDiv);

        var dismissBtn = document.createElement('button');
        dismissBtn.innerHTML = 'OK';
        tooManyCharsDiv.appendChild(dismissBtn);

        dismissBtn.addEventListener('click', () => {
          console.log('dismiss button click');
          // document.styleSheets[0].addRule('.dialogueBox h2:before','content: "";');
          tooManyCharsDiv.remove();
          document.getElementById('textarea').focus();
        })
      }

      function areYouSure(){
        console.log('are you sure dialogue box?');
      }

      const boldBtn = document.querySelector('#bold-btn');
      const italicBtn = document.querySelector('#italic-btn');
      const underlineBtn = document.querySelector('#underline-btn');
      const strikethroughBtn = document.querySelector('#strikethrough-btn');
      const subscriptBtn = document.querySelector('#subscript-btn');
      const superscriptBtn = document.querySelector('#superscript-btn');

      boldBtn.addEventListener('click', () => {
        document.execCommand('bold');
        document.getElementById('textarea').focus();
        document.getElementById('textarea').select();
      });
      italicBtn.addEventListener('click', () => {
        document.execCommand('italic');
        document.getElementById('textarea').focus();
        document.getElementById('textarea').select();
      });
      underlineBtn.addEventListener('click', () => {
        document.execCommand('underline');
        document.getElementById('textarea').focus();
        document.getElementById('textarea').select();
      });
      strikethroughBtn.addEventListener('click', () => {
        document.execCommand('strikethrough');
        document.getElementById('textarea').focus();
        document.getElementById('textarea').select();
      });
      subscriptBtn.addEventListener('click', () => {
        document.execCommand('subscript');
        document.getElementById('textarea').focus();
        document.getElementById('textarea').select();
      });
      superscriptBtn.addEventListener('click', () => {
        document.execCommand('superscript');
        document.getElementById('textarea').focus();
        document.getElementById('textarea').select();
      });

      //----- controls chat control button dropdowns -----//
      document.addEventListener("click", e => {
        // console.log('e = ', e)
        // console.log('this is when controls chat control button dropdowns was clicked');
        const isDropdownButton = e.target.matches("[data-dropdown-button]");
        if(!isDropdownButton && e.target.closest('[data-dropdown]') !=null) return;

        let currentDropdown
        if(isDropdownButton){
          currentDropdown = e.target.closest('[data-dropdown]')
          currentDropdown.classList.toggle('active')
          console.log('clicked a drop down button');
        }

        document.querySelectorAll("[data-dropdown].active").forEach(dropdown => {
          if(dropdown === currentDropdown) return
          dropdown.classList.remove("active");
        })
      })

      const initSpoilStatus = document.getElementById('spoilers');
      initSpoilStatus.onchange = function updateSpoilerEye(event){
        console.log('initSpoilStatus = ', initSpoilStatus.value);
        if(initSpoilStatus.value == 'none'){
          document.getElementById('spoiler-label').innerHTML = '&#xe8f4;'
        } else {
          document.getElementById('spoiler-label').innerHTML = '&#xe8f5;'
        }
      }


      document.querySelector("#watersportsBox").addEventListener('click', () => {
        console.log('clicked the watersports filter');
        const collection = document.getElementsByClassName("spoiled-watersports");
        if(document.querySelector("#watersportsBox").checked == true){
          console.log('watersports box is checked');
          for (let i = 0; i < collection.length; i++) {
            collection[i].classList.add("hidden");
            collection[i].classList.remove('show');
          }
        }
        if(document.querySelector("#watersportsBox").checked == false){
          console.log('watersports box is empty');
          for (let i = 0; i < collection.length; i++) {
            collection[i].classList.remove("hidden");
            collection[i].classList.add('show');
          }
        }
      })
      document.querySelector("#disposalBox").addEventListener('click', () => {
        console.log('clicked the disposal filter');
        const collection = document.getElementsByClassName("spoiled-disposal");
        if(document.querySelector("#disposalBox").checked == true){
          console.log('disposal box is checked');
          for (let i = 0; i < collection.length; i++) {
            collection[i].classList.add("hidden");
            collection[i].classList.remove('show');
          }
        }
        if(document.querySelector("#disposalBox").checked == false){
          console.log('disposal box is empty');
          for (let i = 0; i < collection.length; i++) {
            collection[i].classList.remove("hidden");
            collection[i].classList.add('show');
          }
        }
      })
      document.querySelector("#goreBox").addEventListener('click', () => {
        console.log('clicked the gore filter');
        const collection = document.getElementsByClassName("spoiled-gore");
        if(document.querySelector("#goreBox").checked == true){
          console.log('gore box is checked');
          for (let i = 0; i < collection.length; i++) {
            collection[i].classList.add("hidden");
            collection[i].classList.remove('show');
          }
        }
        if(document.querySelector("#goreBox").checked == false){
          console.log('gore box is empty');
          for (let i = 0; i < collection.length; i++) {
            collection[i].classList.remove("hidden");
            collection[i].classList.add('show');
          }
        }
      })





      let editor = document.getElementById('textarea')
      document.onselectionchange = () => {
      	// Check if the editor is focussed
        // console.log('selection changed')
      	if (editor === document.activeElement){
          // console.log('editor is selected');
          if (isSelectionInTag('B')){
            // console.log('bold text selected');
            boldBtn.classList.add('activeBtn');
          } else{
            boldBtn.classList.remove('activeBtn');
          }

          if (isSelectionInTag('I')){
            // console.log('italic text selected');
            italicBtn.classList.add('activeBtn');
          } else{
            italicBtn.classList.remove('activeBtn');
          }

          if (isSelectionInTag('U')){
            // console.log('underlined text selected');
            underlineBtn.classList.add('activeBtn');
          } else{
            underlineBtn.classList.remove('activeBtn');
          }

          if (isSelectionInTag('STRIKE')){
            // console.log('strikethrough text selected');
            strikethroughBtn.classList.add('activeBtn');
          } else{
            // console.log(' text deselected');
            strikethroughBtn.classList.remove('activeBtn');
          }

          if (isSelectionInTag('SUB')){
            // console.log('subscript text selected');
            subscriptBtn.classList.add('activeBtn');
          } else{
            // console.log('bold text deselected');
            subscriptBtn.classList.remove('activeBtn');
          }

          if (isSelectionInTag('SUP')){
            // console.log('superscript text selected');
            superscriptBtn.classList.add('activeBtn');
          } else{
            superscriptBtn.classList.remove('activeBtn');
          }
      	}
      }

      function isSelectionInTag(tag){
      	// Get the current node
      	let currentNode = window.getSelection().focusNode;
        // console.log('currentNode = ', currentNode);
        // console.log('currentNode.id = ', currentNode.id);
      	// While the node is not the editor division
        // if(currentNode.id){
          while (currentNode.id !== 'textarea')
        	{
            // console.log('currentNode.tagName', currentNode.tagName);
        		// Check if the node is the requested tag
        		if (currentNode.tagName === tag) return true;
        		// Move up in the tree
        		currentNode = currentNode.parentNode;
        	}
        	return false;
        // }
      }























      //----- creating clickable UI buttons -----//

      var input = document.getElementById("lookTab");
      input.addEventListener("click", function(event) {
        event.preventDefault();
        console.log('Look tab was clicked!');
        document.getElementById("lookDisplay").style.display = "block";
        document.getElementById("itemsDisplay").style.display = "none";
        document.getElementById("spellsDisplay").style.display = "none";
        document.getElementById("mapDisplay").style.display = "none";
        document.getElementById("voreDisplay").style.display = "none";
        document.getElementById("optionsDisplay").style.display = "none";
      });
      var input = document.getElementById("itemsTab");
      input.addEventListener("click", function(event) {
        event.preventDefault();
        console.log('items tab was clicked!');
        document.getElementById("itemsDisplay").style.display = "block";
        document.getElementById("lookDisplay").style.display = "none";
        document.getElementById("spellsDisplay").style.display = "none";
        document.getElementById("mapDisplay").style.display = "none";
        document.getElementById("voreDisplay").style.display = "none";
        document.getElementById("optionsDisplay").style.display = "none";
      });
      var input = document.getElementById("spellsTab");
      input.addEventListener("click", function(event) {
        event.preventDefault();
        console.log('spells tab was clicked!');
        document.getElementById("spellsDisplay").style.display = "block";
        document.getElementById("lookDisplay").style.display = "none";
        document.getElementById("itemsDisplay").style.display = "none";
        document.getElementById("mapDisplay").style.display = "none";
        document.getElementById("voreDisplay").style.display = "none";
        document.getElementById("optionsDisplay").style.display = "none";
      });
      const fill = document.querySelector('.fill');
      const empties = document.querySelectorAll('.empty');

      // Fill Listeners
      //fill.addEventListener('dragstart', dragStart);
      //fill.addEventListener('dragend', dragEnd);

      // Loop Through Empties and call drag events
      for(const empty of empties) {
        empty.addEventListener('dragover', dragOver);
        empty.addEventListener('dragenter', dragEnter);
        empty.addEventListener('dragleave', dragLeave);
        empty.addEventListener('drop', dragDrop);
      }

      // Drag Functions
      function dragStart() {
        console.log('dragging started');
        this.className += ' hold';
        setTimeout(() => (this.className = 'invisible'), 0);
        }
      function dragEnd() {
        console.log('dragging ended');
        this.className = 'fill';
      }
      function dragOver(event) {
        event.preventDefault();
      }
      function dragEnter(event) {
        event.preventDefault();
        this.className += ' hovered';
      }
      function dragLeave() {
        this.className = 'empty';
      }
      function dragDrop() {
        this.className = 'empty';
        this.append(fill);
      }

      var input = document.getElementById("mapTab");
      input.addEventListener("click", function(event) {
        event.preventDefault();
        console.log('map tab was clicked!');
        document.getElementById("mapDisplay").style.display = "block";
        document.getElementById("lookDisplay").style.display = "none";
        document.getElementById("itemsDisplay").style.display = "none";
        document.getElementById("spellsDisplay").style.display = "none";
        document.getElementById("voreDisplay").style.display = "none";
        document.getElementById("optionsDisplay").style.display = "none";
      });
      var input = document.getElementById("voreTab");
      input.addEventListener("click", function(event) {
        event.preventDefault();
        console.log('Vore tab was clicked!');
        document.getElementById("voreDisplay").style.display = "block";
        document.getElementById("lookDisplay").style.display = "none";
        document.getElementById("itemsDisplay").style.display = "none";
        document.getElementById("spellsDisplay").style.display = "none";
        document.getElementById("mapDisplay").style.display = "none";
        document.getElementById("optionsDisplay").style.display = "none";
      });







      var coll = document.getElementsByClassName("collapsible");
      var i;
      for (i = 0; i < coll.length; i++) {
        coll[i].addEventListener("click", function() {
          this.classList.toggle("active");
          var content = this.nextElementSibling;
          if (content.style.maxHeight){
            content.style.maxHeight = null;
          } else {
            content.style.maxHeight = content.scrollHeight + "px";
          }
        });
      }
      var voreContextMenu = document.getElementsByClassName("specialActions");
      var specialI;
      var specialDivList = [];
      for (specialI = 0; specialI < voreContextMenu.length; specialI++) {

        specialDivList.push(voreContextMenu[specialI]);
        voreContextMenu[specialI].addEventListener("click", function() {
          console.log("Special Menu Input in Context Menu was Clicked");
          if (localPlayerInfo.specialList == specialDivList) {
            //console.log('voreContextMenu = ', voreContextMenu);
            //console.log('specialI = ', specialI);
            console.log('specialDivList = ', specialDivList);
            console.log('localPlayerInfo.specialList = ', localPlayerInfo.specialList);
          }
        });
      }


      this.socket.on('newvoreContextMenu', function (voreEntry) {

        localPlayerInfo.specialList.push(voreEntry);
        console.log('special create button clicked by', localPlayerInfo.playerId, '\n', 'confirming inputs of: ', '\n', 'Special Name = ', voreEntry.Name, '\n', 'Special Verb = ', voreEntry.Verb, '\n', 'Special Description = ', voreEntry.Descrip);
        console.log('testing the push array thingy: ', localPlayerInfo.specialList[localPlayerInfo.specialList.length - 1]);
        //creating a new custom vore optoin
        document.getElementById("specialEdit").style.display = "none";
      });

      this.socket.on('playerConsumed', function (pred, prey) {
        console.log('pred = ', pred, '\n', 'prey = ', prey);
        if (prey.playerId === self.socket.id) {
          console.log('you are prey');
          //self.avatar.head.setTexture('emptyplayer');
          playerContainer.visible = false;
          for (let i = 0; i < otherPlayers.length; i++) {
            if (pred.playerId === otherPlayers[i].playerId) {
              console.log('you were swallowed whole by', pred.Username);
              cam1.startFollow(otherPlayers[i]);
            }
          }
        } else {
        console.log('you are not prey');
        for (let i = 0; i < otherPlayers.length; i++) {
          if (prey.playerId === otherPlayers[i].playerId) {
            console.log(pred.Username, ' swallowed ', prey.Username, ' whole!');
            console.log('otherPlayers[i] = ', otherPlayers[i]);
            otherPlayers[i].visible = false;
            }
          }
        }
      })


      this.socket.on('grabbedInfo', function (grabbedPlayer) {
        console.log('grabbedPlayer = ', grabbedPlayer);

      })
      this.socket.on('grippedFirmlyInfo', function (grippedFirmlyPlayer) {
        console.log('grippedFirmlyPlayer = ', grippedFirmlyPlayer);

      })
      

      var input = document.getElementById("optionsTab");
      input.addEventListener("click", function(event) {
        event.preventDefault();
        console.log('options tab was clicked!');
        document.getElementById("optionsDisplay").style.display = "block";
        document.getElementById("lookDisplay").style.display = "none";
        document.getElementById("itemsDisplay").style.display = "none";
        document.getElementById("spellsDisplay").style.display = "none";
        document.getElementById("mapDisplay").style.display = "none";
        document.getElementById("voreDisplay").style.display = "none";
      });














      const game = this;
      console.log('Create Started');

      //----- Loads the json  file and also the map tileset -----//
      // const map = this.make.tilemap({key: 'level_2'});
      const map = this.make.tilemap({key: 'tastytails_v01'});
      // const tileset = map.addTilesetImage('spritesheet');
      const tileset = map.addTilesetImage('tileset');

      //----- Loads a Dynamic Tilemap Layer -----//
      // const layer = map.createLayer('test', tileset, 0, 0);
      // layer.putTileAtWorldXY(9, 3291, 4287);
      // const testTile = layer.getTileAtWorldXY(3291, 4287);
      // testTile.depth = testTile.y*32;
      // console.log('testTile = ', testTile);
      const testTile = this.add.sprite(3291, 4287, 'tilesetSprite', 8);
      testTile.depth = testTile.y-92;
      console.log('testTile = ', testTile);
      


      //----- Creates "layers" of different map tiles to be placed on top of one another -----//
      const spawn = map.createLayer('spawn', tileset, 0, 0);
      const shadows = map.createLayer('shadows', tileset, 0, 0);
      blocked_tiles = map.createLayer('blocked_tiles', tileset, 0, 0);
      const buildingFronts = map.createLayer('buildingFronts', tileset, 0, 0);
      const buildings2 = map.createLayer('buildings_2', tileset, 0, 0);
      const trees = map.createLayer('trees', tileset, 0, 0);
      obj_spawning = map.createLayer('obj_spawning', tileset, 0, 0);
      const water = map.createLayer('water', tileset, 0, 0);
      const paths = map.createLayer('paths', tileset, 0, 0);
      const paths_2 = map.createLayer('paths_2', tileset, 0, 0);
      const paths_3 = map.createLayer('paths_3', tileset, 0, 0);
      const sand = map.createLayer('sand', tileset, 0, 0);
      const grass = map.createLayer('grass', tileset, 0, 0);

      //----- defines the height that each map layer is displayed at and what tile IDs player can collide with -----//
      spawn.depth = 0;
      //spawn.setCollision(-1);
      shadows.depth = -1;
      //shadows.setCollision(-1);
      blocked_tiles.depth = -1;
      //blocked_tiles.setCollision(-1);
      //map.setCollisionByProperty({collide: true });
      // blocked_tiles.setCollisionByExclusion(-1, true);
      blocked_tiles.setCollisionByProperty({ collides: true });
      //blocked_tiles.setDepthByExclusion(-1, true);
      //blocked_tiles.setCollisionFromCollisionGroup();
      buildingFronts.depth = 1;
      buildings2.depth = 10000;
      console.log('buildings2 = ', buildings2);
      trees.depth = 2;
      //trees.setCollision(-1);

      //----- function to create trees out of multiple tiles -----//
      function treeCreator(self, info, x, y, depth){
        console.log('treeCreator function called');
        const treeSpriteContainer = self.add.container(0,0);
        const treeSpriteOriginX = 0;
        const treeSpriteOriginY = 0;

        const treeTrunk01 = self.physics.add.sprite(treeSpriteOriginX, treeSpriteOriginY, 'tilesetSprite', 1461);
        console.log('treeTrunk01 = ', treeTrunk01)
        treeSpriteContainer.add(treeTrunk01);
        const treeTrunk02 = self.physics.add.sprite(treeSpriteOriginX-32, treeSpriteOriginY, 'tilesetSprite', 1460);
        treeSpriteContainer.add(treeTrunk02);
        const treeTrunk03 = self.physics.add.sprite(treeSpriteOriginX+32, treeSpriteOriginY, 'tilesetSprite', 1462);
        treeSpriteContainer.add(treeTrunk03);
        const treeTrunk04 = self.physics.add.sprite(treeSpriteOriginX, treeSpriteOriginY-32, 'tilesetSprite', 1365);
        treeSpriteContainer.add(treeTrunk04);
        const treeTrunk05 = self.physics.add.sprite(treeSpriteOriginX, treeSpriteOriginY-64, 'tilesetSprite', 1269);
        treeSpriteContainer.add(treeTrunk05);
        const treeTrunk06 = self.physics.add.sprite(treeSpriteOriginX, treeSpriteOriginY-96, 'tilesetSprite', 1173);
        treeSpriteContainer.add(treeTrunk06);

        treeSpriteContainer.setPosition(x, y);
        treeSpriteContainer.depth = treeSpriteContainer.y-118;

        console.log('treeSpriteContainer = ', treeSpriteContainer);
      }
      

      obj_spawning.depth = -1;
      obj_spawning.setCollisionByExclusion(-1, true);
      console.log('obj_spawning = ', obj_spawning);
      //universal layer modifier for Y axis = -185
      for (let i = 0; i < obj_spawning.layer.data.length; i++) {
        let objTile = obj_spawning.layer.data[i];
        for (let info = 0; info < objTile.length; info++) {
          if (objTile[info].index > -1) {
            if (objTile[info].properties.label == 'tree_01') {
              //console.log('success tree01');
              // var tempObj = this.add.image((objTile[info].x*32)+19, (objTile[info].y*32)-223.5, 'tree_01');
              // tempObj.depth = (objTile[info].y*32)-60;
              console.log('objTile[info]] = ', objTile[info]);
              var tree = treeCreator(this, objTile[info], (objTile[info].x*32)+16, (objTile[info].y*32)+16, objTile[info].y*32);
            }
            if (objTile[info].properties.label == 'tree_02') {
              //console.log('success tree02');
              var tempObj = this.add.image((objTile[info].x*32)+19, (objTile[info].y*32)-223.5, 'tree_02');
              tempObj.depth = (objTile[info].y*32)-60;
            }
            if (objTile[info].properties.label == 'lamp_01') {
              //console.log('success lamp01');
              var tempObj = this.add.image((objTile[info].x*32)+32, (objTile[info].y*32)-125, 'lamp_01');
              tempObj.depth = (objTile[info].y*32)-60;
            }
            if (objTile[info].properties.label == 'lamp_02') {
              //console.log('success lamp02');
              var tempObj = this.add.image((objTile[info].x*32)+32, (objTile[info].y*32)-125, 'lamp_02');
              tempObj.depth = (objTile[info].y*32)-60;
            }
            //console.log('objTile X = ', objTile[info].x, '\n', 'objTile Y = ', objTile[info].y, '\n', 'objTileInfo = ', objTile[info].properties.label);
          }
        }
      }


      

      var cloth_shelf_01 = this.physics.add.image(10548, 4085, 'cloth_shelf_01');
      cloth_shelf_01.depth = (cloth_shelf_01.y);
      cloth_shelf_01.setSize(169, 100);
      cloth_shelf_01.setOffset(0, 110);
      cloth_shelf_01.setImmovable(true);
      this.physics.add.collider(this.players, cloth_shelf_01);

      var cloth_shelf_02 = this.physics.add.image(10716, 4085, 'cloth_shelf_02');
      cloth_shelf_02.depth = (cloth_shelf_02.y);
      cloth_shelf_02.setSize(169, 100);
      cloth_shelf_02.setOffset(0, 110);
      cloth_shelf_02.setImmovable(true);
      this.physics.add.collider(this.players, cloth_shelf_02);

      var mirror_01 = this.physics.add.image(10848, 4082, 'mirror_01');
      mirror_01.depth = (mirror_01.y+15);
      mirror_01.setSize(40, 51);
      mirror_01.setOffset(0, 100);
      mirror_01.setImmovable(true);
      this.physics.add.collider(this.players, mirror_01);

      var mannequin_00 = this.physics.add.image(11091, 4051, 'mannequin_00');
      mannequin_00.depth = (mannequin_00.y+55);
      mannequin_00.setSize(31, 25);
      mannequin_00.setOffset(15.5, 138);
      mannequin_00.setImmovable(true);
      this.physics.add.collider(this.players, mannequin_00);

      var mannequin_01 = this.physics.add.image(10934, 4051, 'mannequin_01');
      mannequin_01.depth = (mannequin_01.y+55);
      mannequin_01.setSize(31, 25);
      mannequin_01.setOffset(15.5, 138);
      mannequin_01.setImmovable(true);
      this.physics.add.collider(this.players, mannequin_01);

      var mannequin_02 = this.physics.add.image(11017, 4051, 'mannequin_02');
      mannequin_02.depth = (mannequin_02.y+55);
      mannequin_02.setSize(31, 25);
      mannequin_02.setOffset(15.5, 138);
      mannequin_02.setImmovable(true);
      this.physics.add.collider(this.players, mannequin_02);

      var mannequin_03 = this.physics.add.image(10470, 4421, 'mannequin_00');
      mannequin_03.depth = (mannequin_03.y+55);
      mannequin_03.setSize(31, 25);
      mannequin_03.setOffset(15.5, 138);
      mannequin_03.setImmovable(true);
      this.physics.add.collider(this.players, mannequin_03);

      var sewing_machine_01 = this.physics.add.image(11040, 4200, 'sewing_machine_01');
      sewing_machine_01.depth = (sewing_machine_01.y+55);
      sewing_machine_01.setSize(84, 40);
      sewing_machine_01.setOffset(0, 97);
      sewing_machine_01.setImmovable(true);
      this.physics.add.collider(this.players, sewing_machine_01);

      var cloth_roll_basket01 = this.physics.add.image(10472, 4272, 'cloth_roll_basket01');
      cloth_roll_basket01.depth = (cloth_roll_basket01.y+55);
      cloth_roll_basket01.setSize(52, 30);
      cloth_roll_basket01.setOffset(0, 144);
      cloth_roll_basket01.setImmovable(true);
      this.physics.add.collider(this.players, cloth_roll_basket01);

      var yarn_basket_01 = this.physics.add.image(10486, 4368, 'yarn_basket_01');
      yarn_basket_01.depth = (yarn_basket_01.y);
      yarn_basket_01.setSize(61, 22);
      yarn_basket_01.setOffset(0, 22);
      yarn_basket_01.setImmovable(true);
      this.physics.add.collider(this.players, yarn_basket_01);




      //----- Drawing the Pub -----//
      //----- Bottom Right Table -----//
      var pub_table_01 = this.physics.add.image(10485, 3251, 'pub_table');
      pub_table_01.depth = (pub_table_01.y);
      pub_table_01.setSize(218, 33);
      pub_table_01.setOffset(0, 68);
      pub_table_01.setImmovable(true);
      this.physics.add.collider(this.players, pub_table_01);

      var pub_stool_01 = this.physics.add.image(10550, 3300, 'pub_stool');
      pub_stool_01.depth = (pub_stool_01.y);
      pub_stool_01.setSize(35, 24);
      pub_stool_01.setOffset(0, 24);
      pub_stool_01.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_01);

      var pub_stool_02 = this.physics.add.image(10485, 3300, 'pub_stool');
      pub_stool_02.depth = (pub_stool_02.y);
      pub_stool_02.setSize(35, 24);
      pub_stool_02.setOffset(0, 24);
      pub_stool_02.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_02);

      var pub_stool_03 = this.physics.add.image(10420, 3300, 'pub_stool');
      pub_stool_03.depth = (pub_stool_03.y);
      pub_stool_03.setSize(35, 24);
      pub_stool_03.setOffset(0, 24);
      pub_stool_03.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_03);

      var pub_stool_04 = this.physics.add.image(10550, 3200, 'pub_stool');
      pub_stool_04.depth = (pub_stool_04.y);
      pub_stool_04.setSize(35, 24);
      pub_stool_04.setOffset(0, 24);
      pub_stool_04.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_04);

      var pub_stool_05 = this.physics.add.image(10485, 3200, 'pub_stool');
      pub_stool_05.depth = (pub_stool_05.y);
      pub_stool_05.setSize(35, 24);
      pub_stool_05.setOffset(0, 24);
      pub_stool_05.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_05);

      var pub_stool_06 = this.physics.add.image(10420, 3200, 'pub_stool');
      pub_stool_06.depth = (pub_stool_06.y);
      pub_stool_06.setSize(35, 24);
      pub_stool_06.setOffset(0, 24);
      pub_stool_06.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_06);

      //----- Top Right Table -----//

      var pub_table_02 = this.physics.add.image(10485, 3050, 'pub_table');
      pub_table_02.depth = (pub_table_02.y);
      pub_table_02.setSize(218, 33);
      pub_table_02.setOffset(0, 68);
      pub_table_02.setImmovable(true);
      this.physics.add.collider(this.players, pub_table_02);

      var pub_stool_07 = this.physics.add.image(10550, 3100, 'pub_stool');
      pub_stool_07.depth = (pub_stool_07.y);
      pub_stool_07.setSize(35, 24);
      pub_stool_07.setOffset(0, 24);
      pub_stool_07.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_07);

      var pub_stool_08 = this.physics.add.image(10485, 3100, 'pub_stool');
      pub_stool_08.depth = (pub_stool_08.y);
      pub_stool_08.setSize(35, 24);
      pub_stool_08.setOffset(0, 24);
      pub_stool_08.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_08);

      var pub_stool_09 = this.physics.add.image(10420, 3100, 'pub_stool');
      pub_stool_09.depth = (pub_stool_09.y);
      pub_stool_09.setSize(35, 24);
      pub_stool_09.setOffset(0, 24);
      pub_stool_09.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_09);

      var pub_stool_10 = this.physics.add.image(10550, 3000, 'pub_stool');
      pub_stool_10.depth = (pub_stool_10.y);
      pub_stool_10.setSize(35, 24);
      pub_stool_10.setOffset(0, 24);
      pub_stool_10.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_10);

      var pub_stool_11 = this.physics.add.image(10485, 3000, 'pub_stool');
      pub_stool_11.depth = (pub_stool_11.y);
      pub_stool_11.setSize(35, 24);
      pub_stool_11.setOffset(0, 24);
      pub_stool_11.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_11);

      var pub_stool_12 = this.physics.add.image(10420, 3000, 'pub_stool');
      pub_stool_12.depth = (pub_stool_12.y);
      pub_stool_12.setSize(35, 24);
      pub_stool_12.setOffset(0, 24);
      pub_stool_12.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_12);

      //----- Bottom Left Tble -----//

      var pub_table_03 = this.physics.add.image(10135, 3251, 'pub_table');
      pub_table_03.depth = (pub_table_03.y);
      pub_table_03.setSize(218, 33);
      pub_table_03.setOffset(0, 68);
      pub_table_03.setImmovable(true);
      this.physics.add.collider(this.players, pub_table_03);

      var pub_stool_13 = this.physics.add.image(10200, 3300, 'pub_stool');
      pub_stool_13.depth = (pub_stool_13.y);
      pub_stool_13.setSize(35, 24);
      pub_stool_13.setOffset(0, 24);
      pub_stool_13.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_13);

      var pub_stool_14 = this.physics.add.image(10135, 3300, 'pub_stool');
      pub_stool_14.depth = (pub_stool_14.y);
      pub_stool_14.setSize(35, 24);
      pub_stool_14.setOffset(0, 24);
      pub_stool_14.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_14);

      var pub_stool_15 = this.physics.add.image(10070, 3300, 'pub_stool');
      pub_stool_15.depth = (pub_stool_15.y);
      pub_stool_15.setSize(35, 24);
      pub_stool_15.setOffset(0, 24);
      pub_stool_15.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_15);

      var pub_stool_16 = this.physics.add.image(10200, 3200, 'pub_stool');
      pub_stool_16.depth = (pub_stool_16.y);
      pub_stool_16.setSize(35, 24);
      pub_stool_16.setOffset(0, 24);
      pub_stool_16.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_16);

      var pub_stool_17 = this.physics.add.image(10135, 3200, 'pub_stool');
      pub_stool_17.depth = (pub_stool_17.y);
      pub_stool_17.setSize(35, 24);
      pub_stool_17.setOffset(0, 24);
      pub_stool_17.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_17);

      var pub_stool_18 = this.physics.add.image(10070, 3200, 'pub_stool');
      pub_stool_18.depth = (pub_stool_18.y);
      pub_stool_18.setSize(35, 24);
      pub_stool_18.setOffset(0, 24);
      pub_stool_18.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_18);

      //----- Top Left Table -----//

      var pub_table_04 = this.physics.add.image(10135, 3050, 'pub_table');
      pub_table_04.depth = (pub_table_04.y);
      pub_table_04.setSize(218, 33);
      pub_table_04.setOffset(0, 68);
      pub_table_04.setImmovable(true);
      this.physics.add.collider(this.players, pub_table_04);

      var pub_stool_19 = this.physics.add.image(10200, 3100, 'pub_stool');
      pub_stool_19.depth = (pub_stool_19.y);
      pub_stool_19.setSize(35, 24);
      pub_stool_19.setOffset(0, 24);
      pub_stool_19.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_19);

      var pub_stool_20 = this.physics.add.image(10135, 3100, 'pub_stool');
      pub_stool_20.depth = (pub_stool_20.y);
      pub_stool_20.setSize(35, 24);
      pub_stool_20.setOffset(0, 24);
      pub_stool_20.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_20);

      var pub_stool_21 = this.physics.add.image(10070, 3100, 'pub_stool');
      pub_stool_21.depth = (pub_stool_21.y);
      pub_stool_21.setSize(35, 24);
      pub_stool_21.setOffset(0, 24);
      pub_stool_21.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_21);

      var pub_stool_22 = this.physics.add.image(10200, 3000, 'pub_stool');
      pub_stool_22.depth = (pub_stool_22.y);
      pub_stool_22.setSize(35, 24);
      pub_stool_22.setOffset(0, 24);
      pub_stool_22.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_22);

      var pub_stool_23 = this.physics.add.image(10135, 3000, 'pub_stool');
      pub_stool_23.depth = (pub_stool_23.y);
      pub_stool_23.setSize(35, 24);
      pub_stool_23.setOffset(0, 24);
      pub_stool_23.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_23);

      var pub_stool_24 = this.physics.add.image(10070, 3000, 'pub_stool');
      pub_stool_24.depth = (pub_stool_24.y);
      pub_stool_24.setSize(35, 24);
      pub_stool_24.setOffset(0, 24);
      pub_stool_24.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_24);

      //----- Card Tables and Stools -----//
      //----- Top Card Table -----//
      var card_table_01 = this.physics.add.image(9830, 2750, 'card_table');
      card_table_01.depth = (card_table_01.y+35);
      card_table_01.setSize(153, 130);
      card_table_01.setOffset(0, 25);
      card_table_01.setImmovable(true);
      this.physics.add.collider(this.players, card_table_01);

      var pub_stool_25 = this.physics.add.image(9925, 3050, 'pub_stool');
      pub_stool_25.depth = (pub_stool_25.y);
      pub_stool_25.setSize(35, 24);
      pub_stool_25.setOffset(0, 24);
      pub_stool_25.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_25);

      var pub_stool_26 = this.physics.add.image(9885, 3130, 'pub_stool');
      pub_stool_26.depth = (pub_stool_26.y);
      pub_stool_26.setSize(35, 24);
      pub_stool_26.setOffset(0, 24);
      pub_stool_26.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_26);

      var pub_stool_27 = this.physics.add.image(9785, 3130, 'pub_stool');
      pub_stool_27.depth = (pub_stool_27.y);
      pub_stool_27.setSize(35, 24);
      pub_stool_27.setOffset(0, 24);
      pub_stool_27.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_27);

      var pub_stool_28 = this.physics.add.image(9725, 3050, 'pub_stool');
      pub_stool_28.depth = (pub_stool_28.y);
      pub_stool_28.setSize(35, 24);
      pub_stool_28.setOffset(0, 24);
      pub_stool_28.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_28);

      var pub_stool_29 = this.physics.add.image(9885, 2970, 'pub_stool');
      pub_stool_29.depth = (pub_stool_29.y);
      pub_stool_29.setSize(35, 24);
      pub_stool_29.setOffset(0, 24);
      pub_stool_29.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_29);

      var pub_stool_30 = this.physics.add.image(9785, 2970, 'pub_stool');
      pub_stool_30.depth = (pub_stool_30.y);
      pub_stool_30.setSize(35, 24);
      pub_stool_30.setOffset(0, 24);
      pub_stool_30.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_30);

      //----- Bottom Card Table -----//

      var card_table_02 = this.physics.add.image(9830, 3050, 'card_table');
      card_table_02.depth = (card_table_02.y+35);
      card_table_02.setSize(153, 130);
      card_table_02.setOffset(0, 25);
      card_table_02.setImmovable(true);
      this.physics.add.collider(this.players, card_table_02);

      var pub_stool_31 = this.physics.add.image(9925, 2750, 'pub_stool');
      pub_stool_31.depth = (pub_stool_31.y);
      pub_stool_31.setSize(35, 24);
      pub_stool_31.setOffset(0, 24);
      pub_stool_31.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_31);

      var pub_stool_32 = this.physics.add.image(9885, 2830, 'pub_stool');
      pub_stool_32.depth = (pub_stool_32.y);
      pub_stool_32.setSize(35, 24);
      pub_stool_32.setOffset(0, 24);
      pub_stool_32.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_32);

      var pub_stool_33 = this.physics.add.image(9785, 2830, 'pub_stool');
      pub_stool_33.depth = (pub_stool_33.y);
      pub_stool_33.setSize(35, 24);
      pub_stool_33.setOffset(0, 24);
      pub_stool_33.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_33);

      var pub_stool_34 = this.physics.add.image(9725, 2750, 'pub_stool');
      pub_stool_34.depth = (pub_stool_34.y);
      pub_stool_34.setSize(35, 24);
      pub_stool_34.setOffset(0, 24);
      pub_stool_34.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_34);

      var pub_stool_35 = this.physics.add.image(9885, 2670, 'pub_stool');
      pub_stool_35.depth = (pub_stool_35.y);
      pub_stool_35.setSize(35, 24);
      pub_stool_35.setOffset(0, 24);
      pub_stool_35.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_35);

      var pub_stool_36 = this.physics.add.image(9785, 2670, 'pub_stool');
      pub_stool_36.depth = (pub_stool_36.y);
      pub_stool_36.setSize(35, 24);
      pub_stool_36.setOffset(0, 24);
      pub_stool_36.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_36);



      //----- Bar Front -----//

      var bar_front = this.physics.add.image(10432, 2848, 'bar_front');
      bar_front.depth = (bar_front.y+35);
      bar_front.setSize(768, 34);
      bar_front.setOffset(0, 94);
      bar_front.setImmovable(true);
      this.physics.add.collider(this.players, bar_front);

      var pub_stool_tall_01 = this.physics.add.image(10100, 2900, 'pub_stool_tall');
      pub_stool_tall_01.depth = (pub_stool_tall_01.y+25);
      pub_stool_tall_01.setSize(35, 33);
      pub_stool_tall_01.setOffset(0, 33);
      pub_stool_tall_01.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_tall_01);

      var pub_stool_tall_02 = this.physics.add.image(10200, 2900, 'pub_stool_tall');
      pub_stool_tall_02.depth = (pub_stool_tall_02.y+25);
      pub_stool_tall_02.setSize(35, 33);
      pub_stool_tall_02.setOffset(0, 33);
      pub_stool_tall_02.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_tall_02);

      var pub_stool_tall_03 = this.physics.add.image(10300, 2900, 'pub_stool_tall');
      pub_stool_tall_03.depth = (pub_stool_tall_03.y+25);
      pub_stool_tall_03.setSize(35, 33);
      pub_stool_tall_03.setOffset(0, 33);
      pub_stool_tall_03.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_tall_03);

      var pub_stool_tall_04 = this.physics.add.image(10400, 2900, 'pub_stool_tall');
      pub_stool_tall_04.depth = (pub_stool_tall_04.y+25);
      pub_stool_tall_04.setSize(35, 33);
      pub_stool_tall_04.setOffset(0, 33);
      pub_stool_tall_04.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_tall_04);

      var pub_stool_tall_05 = this.physics.add.image(10500, 2900, 'pub_stool_tall');
      pub_stool_tall_05.depth = (pub_stool_tall_05.y+25);
      pub_stool_tall_05.setSize(35, 33);
      pub_stool_tall_05.setOffset(0, 33);
      pub_stool_tall_05.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_tall_05);

      var pub_stool_tall_06 = this.physics.add.image(10600, 2900, 'pub_stool_tall');
      pub_stool_tall_06.depth = (pub_stool_tall_06.y+25);
      pub_stool_tall_06.setSize(35, 33);
      pub_stool_tall_06.setOffset(0, 33);
      pub_stool_tall_06.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_tall_06);

      var pub_stool_tall_07 = this.physics.add.image(10700, 2900, 'pub_stool_tall');
      pub_stool_tall_07.depth = (pub_stool_tall_07.y+25);
      pub_stool_tall_07.setSize(35, 33);
      pub_stool_tall_07.setOffset(0, 33);
      pub_stool_tall_07.setImmovable(true);
      this.physics.add.collider(this.players, pub_stool_tall_07);

      //----- Drawing the Spa -----//
      //----- Massage Bed -----//
      var spa_massage_bed_01 = this.physics.add.image(9290, 275, 'spa_massage_bed');
      spa_massage_bed_01.depth = (spa_massage_bed_01.y+25);
      spa_massage_bed_01.setSize(211, 60);
      spa_massage_bed_01.setOffset(0, 41);
      spa_massage_bed_01.setImmovable(true);
      this.physics.add.collider(this.players, spa_massage_bed_01);

      var spa_massage_bed_02 = this.physics.add.image(9802, 275, 'spa_massage_bed');
      spa_massage_bed_02.depth = (spa_massage_bed_02.y+25);
      spa_massage_bed_02.setSize(211, 60);
      spa_massage_bed_02.setOffset(0, 41);
      spa_massage_bed_02.setImmovable(true);
      this.physics.add.collider(this.players, spa_massage_bed_02);

      var spa_massage_bed_03 = this.physics.add.image(10314, 275, 'spa_massage_bed');
      spa_massage_bed_03.depth = (spa_massage_bed_03.y+25);
      spa_massage_bed_03.setSize(211, 60);
      spa_massage_bed_03.setOffset(0, 41);
      spa_massage_bed_03.setImmovable(true);
      this.physics.add.collider(this.players, spa_massage_bed_03);

      var spa_massage_bed_04 = this.physics.add.image(10826, 275, 'spa_massage_bed');
      spa_massage_bed_04.depth = (spa_massage_bed_03.y+25);
      spa_massage_bed_04.setSize(211, 60);
      spa_massage_bed_04.setOffset(0, 41);
      spa_massage_bed_04.setImmovable(true);
      this.physics.add.collider(this.players, spa_massage_bed_04);


      var door_clothing_store = this.physics.add.sprite(6430, 5565, 'door_clothing_store', 0);
      this.physics.add.overlap(self.players, door_clothing_store, useDoor, null, this);
      door_clothing_store.setSize(80, 130);
      self.anims.create({
        key: 'door_clothing_store_open',
        frames: self.anims.generateFrameNumbers('door_clothing_store', { start: 1, end: 0 }),
        frameRate: 6
      })

      var clothing_store_exit_rug = this.physics.add.sprite(10577, 4517, 'clothing_store_exit_rug', 0);
      this.physics.add.overlap(self.players, clothing_store_exit_rug, useDoor, null, this);
      clothing_store_exit_rug.setOffset(0, 55);

      var door_pub = this.physics.add.sprite(4315, 4095, 'door_pub', 0);
      this.physics.add.overlap(self.players, door_pub, useDoor, null, this);
      door_pub.setSize(80, 130);
      self.anims.create({
        key: 'door_pub_open',
        frames: self.anims.generateFrameNumbers('door_pub', { start: 1, end: 0 }),
        frameRate: 6
      })

      var pub_exit_rug = this.physics.add.sprite(10833, 3333, 'pub_exit_rug', 0);
      this.physics.add.overlap(self.players, pub_exit_rug, useDoor, null, this);
      pub_exit_rug.setOffset(0, 55);

      var door_spa = this.physics.add.sprite(3557, 4317, 'door_spa', 0);
      this.physics.add.overlap(self.players, door_spa, useDoor, null, this);
      door_spa.setSize(80, 130);
      self.anims.create({
        key: 'door_spa_open',
        frames: self.anims.generateFrameNumbers('door_spa', { start: 1, end: 0 }),
        frameRate: 6
      })

      function useDoor(players, door) {
        console.log('door.key = ', door.frame.texture.key);
        if(door == door_clothing_store) {
          console.log('Clothing Store door was used');
          door_clothing_store.play('door_clothing_store_open');
          // localPlayerInfo.door = door;
          //self.socket.emit('doorOpened', localPlayerInfo, door);
          //console.log('door_clothing_store', door_clothing_store);
        }
        if(door == door_pub) {
          console.log('Pub door was used');
          door_pub.play('door_pub_open');
          // localPlayerInfo.door = door;
          //self.socket.emit('doorOpened', localPlayerInfo, door);
          //console.log('door_clothing_store', door_clothing_store);
        }
        if(door == door_spa) {
          console.log('Spa door was used');
          door_spa.play('door_spa_open');
          // localPlayerInfo.door = door;
          //self.socket.emit('doorOpened', localPlayerInfo, door);
          //console.log('door_clothing_store', door_clothing_store);
        }
      }
      //cloth_shelf_02.setCollision(true);
      //obj_spawning.setCollision(-1);
      water.depth = -1;
      paths.depth = -2;
      paths_2.depth = -3;
      paths_3.depth = -4;
      //paths.setCollision(-1);
      sand.depth = -5;
      grass.depth = -6;


      console.log('this.debugMode = ', this.game.config.physics.arcade.debug);
      
      if (this.game.config.physics.arcade.debug == true) {
        debugGraphics = this.add.graphics();
          this.input.keyboard.on('keydown-C', function (event) {
            showDebug = !showDebug;
            self.socket.emit('getDebugBounds');
            // drawDebug();
          });
          // frameRate = this.add.text(700, 16, 'FrameRate: ' + game.loop.actualFps, {
          //   fontSize: '18px',
          //   fill: '#ffffff'
          // });
          // frameRate.setScrollFactor(0);
      } else {
        console.log('debug mode turned off');
      }































      //----- makes all the objects you can't walk through -----//
      let blocked = this.physics.add.staticGroup();


      //----- This function is called whenever the local player connects -----//
      //----- It will create the sprites for all players currently online (including themselves) and spawn them into the game world -----//
      function displayPlayers(self, playerInfo) {
        console.log('localPlayerInfo at displayPlayers Function = ', localPlayerInfo);
        console.log(
          playerInfo.playerId, 'Has entered the Game with the following values: ', '\n',
          'Set player First Name to: ', playerInfo.firstName, '\n',
          'Set player Last Name to: ', playerInfo.lastName, '\n',
          'Set player Nick Name to: ', playerInfo.nickName, '\n \n',

          'Set head Sprite to: ', playerInfo.head.sprite, '\n',
          'Set head Color to: ', playerInfo.head.color, '\n',
          'Set head Secondary Sprite to: ', playerInfo.head.secondarySprite, '\n',
          'Set head Secondary Color to: ', playerInfo.head.secondaryColor, '\n',
          'Set head Accent Sprite to: ', playerInfo.head.accentSprite, '\n',
          'Set head Accent Color to: ', playerInfo.head.accentColor, '\n \n',

          'Set body Sprite to: ', playerInfo.body.sprite, '\n',
          'Set body Color to: ', playerInfo.body.color, '\n',
          'Set body Secondary Sprite to: ', playerInfo.body.secondarySprite, '\n',
          'Set body Secondary Color to: ', playerInfo.body.secondaryColor, '\n',
          'Set body Accent Sprite to: ', playerInfo.body.accentSprite, '\n',
          'Set body Accent Color to: ', playerInfo.body.accentColor, '\n \n',

          'Set tail Sprite to: ', playerInfo.tail.sprite, '\n',
          'Set tail Color to: ', playerInfo.tail.color, '\n',
          'Set tail Secondary Sprite to: ', playerInfo.tail.secondarySprite, '\n',
          'Set tail Secondary Color to: ', playerInfo.tail.secondaryColor, '\n',
          'Set tail Accent Sprite to: ', playerInfo.tail.accentSprite, '\n',
          'Set tail Accent Color to: ', playerInfo.tail.accentColor, '\n',
          'Set hands Sprite to: ', playerInfo.hands.sprite, '\n',
          'Set hands Color to: ', playerInfo.hands.color, '\n',
          'Set feet Sprite to: ', playerInfo.feet.sprite, '\n',
          'Set feet Color to: ', playerInfo.feet.color, '\n \n',

          'Set hair Sprite to: ', playerInfo.hair.sprite, '\n',
          'Set hair Color to: ', playerInfo.hair.color, '\n',
          'Set earOuter Sprite to: ', playerInfo.ear.outerSprite, '\n',
          'Set earOuter Color to: ', playerInfo.ear.outerColor, '\n',
          'Set earInner Sprite to: ', playerInfo.ear.innerSprite, '\n',
          'Set earInner Color to: ', playerInfo.ear.innerColor, '\n',
          'Set outer eyes sprite to:', playerInfo.eyes.outer, '\n',
          'Set irises to:', playerInfo.eyes.iris, '\n',
          'Set eye color to:', playerInfo.eyes.color, '\n',
          'Set beak to:', playerInfo.beak.sprite, '\n',
          'Set beak color to:', playerInfo.beak.color, '\n',
          'Set head accessories to:', playerInfo.headAccessories.sprite, '\n',
          'Set head accessories color to:', playerInfo.headAccessories.color, '\n',
          'Set genitles to:', playerInfo.genitles.sprite
        );


        playerContainer = self.add.container(playerInfo.position.x, playerInfo.position.y);
        console.log('coordinatesX = ', playerContainer.x, 'coordinates Y = ', playerContainer.y)
        playerContainer.setSize(60, 163);
        // playerContainer.setSize(60, 15);
        playerContainer.setInteractive();
        self.physics.world.enable(playerContainer);
        playerContainer.body.setOffset(30, -66.5);
        playerContainer.input.hitArea.centerX = 60;
        playerContainer.input.hitArea.centerY = 15;
        // playerContainer.displayOriginX = 54.5;
        // playerContainer.displayOriginY = 110;

        console.log('player coordinates are: X= ', playerInfo.position.x, 'Y= ', playerInfo.position.y);

        //----- the 30, -87 defines the placement of the sprite in the container -----//
        const playerContainerTail = self.add.sprite(30, -87, playerInfo.tail.sprite).setTint(playerInfo.tail.color);
        const playerContainersecondaryTail = self.add.sprite(30, -87, playerInfo.tail.secondarySprite).setTint(playerInfo.tail.secondaryColor);
        const playerContaineraccentTail = self.add.sprite(30, -87, playerInfo.tail.accentSprite).setTint(playerInfo.tail.accentColor);

        const playerContainerbody = self.add.sprite(30, -87, playerInfo.body.sprite).setTint(playerInfo.body.color);
        const playerContainersecondaryBody = self.add.sprite(30, -87, playerInfo.body.secondarySprite).setTint(playerInfo.body.secondaryColor);
        const playerContaineraccentBody = self.add.sprite(30, -87, playerInfo.body.accentSprite).setTint(playerInfo.body.accentColor);
        const playerContainergenitles = self.add.sprite(30, -87, playerInfo.genitles.sprite);
        const playerContainerHands = self.add.sprite(30, -87, playerInfo.hands.sprite).setTint(playerInfo.hands.color);
        const playerContainerFeet = self.add.sprite(30, -87, playerInfo.feet.sprite).setTint(playerInfo.feet.color);

        const playerContainerhead = self.add.sprite(30, -87, playerInfo.head.sprite).setTint(playerInfo.head.color);
        const playerContainersecondaryHead = self.add.sprite(30, -87, playerInfo.head.secondarySprite).setTint(playerInfo.head.secondaryColor);
        const playerContaineraccentHead = self.add.sprite(30, -87, playerInfo.head.accentSprite).setTint(playerInfo.head.accentColor);
        
        const playerContainerBeak = self.add.sprite(30, -87, playerInfo.beak.sprite).setTint(playerInfo.beak.color);

        const playerContainerouterEar = self.add.sprite(30, -87, playerInfo.ear.outerSprite).setTint(playerInfo.ear.outerColor);
        const playerContainerinnerEar = self.add.sprite(30, -87, playerInfo.ear.innerSprite).setTint(playerInfo.ear.innerColor);

        const playerContainereyes = self.add.sprite(30, -87, playerInfo.eyes.outer);
        const playerContaineriris = self.add.sprite(30, -87, playerInfo.eyes.iris).setTint(playerInfo.eyes.color);
        const playerContainerhair = self.add.sprite(30, -87, playerInfo.hair.sprite).setTint(playerInfo.hair.color);
        const playerContainerheadAccessories = self.add.sprite(30, -87, playerInfo.headAccessories.sprite).setTint(playerInfo.headAccessories.color);

        
        


        playerContainer.add([
          playerContainerTail,
          playerContainersecondaryTail,
          playerContaineraccentTail,

          playerContainerbody,
          playerContainersecondaryBody,
          playerContaineraccentBody,
          playerContainergenitles,
          playerContainerHands,
          playerContainerFeet,

          playerContainerhead,
          playerContainersecondaryHead,
          playerContaineraccentHead,

          playerContainerBeak,

          playerContainereyes,
          playerContaineriris,
          playerContainerhair,
          playerContainerouterEar,
          playerContainerinnerEar,
          playerContainerheadAccessories
        ]);

        // playerContainer.sendToBack(playerContainertail);
        // playerContainer.bringToTop(playerContainerhead);
        // playerContainer.bringToTop(playerContainerear);
        // playerContainer.bringToTop(playerContainersecondaryHead);
        // playerContainer.bringToTop(playerContaineraccentHead);

        playerContainer.playerId = playerInfo.playerId;
        self.players.add(playerContainer);
        console.log('playerContainer.body = ', playerContainer.body)
        console.log('self.players = ', self.players);


        // playerContainer.body.setSize(60, 15);


        //console.log('playerContainer = ', playerContainer);
        //console.log('player coordinates are: X= ', playerInfo.position.x, 'Y= ', playerInfo.position.y);

        //self.container.visible = false;
        //localPlayerInfo.sprite = self.stack

        let cam1 = self.cameras.main.setSize(windowSize().x, windowSize().y).startFollow(playerContainer).setName('Camera 1');
        console.log('playerContainer = ', playerContainer);
        console.log('self.players = ', self.players.children.entries[0].list);
        console.log('coordinatesX = ', playerContainer.x, 'coordinates Y = ', playerContainer.y)
        //playerContainer.body.setBoundsRectangle(new Phaser.Geom.Rectangle(10402, 4532, 300, 500));



        // playerContainer.setInteractive();
        // playerContainer.setInteractive(new Phaser.Geom.Rectangle(30, -65, 40, 40), Phaser.Geom.Rectangle.Contains);
        // playerContainer.setInteractive(self.input.makePixelPerfect())
        //  Just to display the hit area, not actually needed to work
        // var graphics = self.add.graphics();
        // graphics.lineStyle(2, 0x00ffff, 1);
        // graphics.strokeCircle(playerContainer.x+30, playerContainer.y-65, playerContainer.input.hitArea.radius);

        let debugRect = self.add.rectangle(playerContainer.x-30, playerContainer.y, playerContainer.input.hitArea.width, playerContainer.input.hitArea.height, 0xff0000);
        debugRect.setDepth(-1);
        // playerContainer.input.hitArea.centerY
        debugRect.displayOriginX = 0;
        debugRect.displayOriginY = 155;
        console.log('debugRect = ', debugRect);



        //self.container.setCollideWorldBounds(false);
        // console.log('self.container = ', self.container);
        // console.log('player coordinates are: X= ', playerInfo.position.x, 'Y= ', playerInfo.position.y);

        document.getElementById('phaserApp').focus();

        playerContainer.on('pointerdown', function (pointer) {
          callRightClickFunction(pointer, playerInfo);
        });
        avatarSelected = true;

        var currentVoreCount = document.getElementById("voreList").childElementCount;
        createVoreList(playerInfo.voreTypes);


        function createVoreList() {
          currentVoreCount = document.getElementById("voreList").childElementCount;
          //console.log('document.getElementById("voreList").childElementCount;', document.getElementById("voreList").childElementCount);
          if (!currentVoreCount) {
            currentVoreCount = 0;
          }
          console.log('playerInfo.voreTypes = ', playerInfo.voreTypes);
          for(i = currentVoreCount; i < playerInfo.voreTypes.length; i++) {
            var li = document.createElement("li");
            var button = document.createElement("button");
            var contentDiv = document.createElement("div");
            //var exitButton = document.createElement("button");
            var chamberContents = document.createElement("div");
            var contentsList = document.createElement("ul");
            var chamberSettings = document.createElement("div");

            var rightClickButton = document.createElement("div");




            rightClickButton.id = 'voreContextMenu'+i;
            rightClickButton.innerHTML = "<p class='voreContextMenu-label'>" + playerInfo.voreTypes[i].destination; + "</p>";
            rightClickButton.className = 'voreContextMenuList';
            var voreMenuUl = document.getElementById("voreMenuUl");
            voreMenuUl.appendChild(rightClickButton);
            rightClickButton.addEventListener("click", function(attemptedVoreActionName) {
              console.log('playerInfo.voreTypes[i] = ', playerInfo.voreTypes[i]);
              console.log('vore clicked = ', clicked);
              console.log('attemptedVoreActionName = ', attemptedVoreActionName);
              self.socket.emit('voreContextMenuClicked', clicked, attemptedVoreActionName.srcElement.innerText);
            });



            button.id = 'vorcordionID='+playerInfo.voreTypes[i]._id;
            //settingsForm.id = playerInfo.voreTypes[i]._id;
            button.innerHTML = "<p class='accordion-label'>" + playerInfo.voreTypes[i].destination; + "</p>";
            button.className = 'accordion';

            // exitButton.innerHTML = '<span>&#x1F5D9;</span>';
            // exitButton.className = 'accordion-close-button';

            contentDiv.id = 'vorcordion-content'+i;
            contentDiv.className = 'accordion-content';
            // contentDiv.innerHTML = "<p>testing the ability to show the content inside the contentDiv</p>";

            //chamberContents.className = 'chamberContents';
            //chamberContents.innerHTML = "<p>Prey held within your " + playerInfo.voreTypes[i].destination; + ": </p>";
            var chamberSettingsBttn = document.createElement('button');
            chamberSettingsBttn.innerHTML = 'Chamber Settings';
            chamberSettingsBttn.id = 'chamberSettingsID='+playerInfo.voreTypes[i]._id;
            contentDiv.appendChild(chamberSettingsBttn);

            var chamberDescriptionsBttn = document.createElement('button');
            chamberDescriptionsBttn.innerHTML = 'Chamber Descriptions';
            chamberDescriptionsBttn.id = 'chamberDescriptionsID='+playerInfo.voreTypes[i]._id;
            contentDiv.appendChild(chamberDescriptionsBttn);


            //----- Creating a Chamber Settings Modal -----//
            var chamberPopUp = document.createElement('div');
            chamberPopUp.className = 'chamberPopUp';
            contentDiv.appendChild(chamberPopUp);
            var chamberPopUpContent = document.createElement('div');
            chamberPopUpContent.className = 'chamberPopUp-Content';
            chamberPopUp.appendChild(chamberPopUpContent);
            var chamberPopUpHeader = document.createElement('div');
            chamberPopUpHeader.className = 'chamberPopUp-header'
            chamberPopUpContent.appendChild(chamberPopUpHeader);
            var chamberPopUpCloseBtn = document.createElement("SPAN");
            chamberPopUpCloseBtn.id = 'chamberSettingsCloseID='+playerInfo.voreTypes[i]._id;
            chamberPopUpCloseBtn.className = 'close';
            chamberPopUpCloseBtn.innerHTML = '&times;'
            chamberPopUpHeader.appendChild(chamberPopUpCloseBtn);
            var chamberPopUpHeaderText = document.createElement('h2');
            chamberPopUpHeaderText.innerHTML = 'Settings For Your '+playerInfo.voreTypes[i].destination
            chamberPopUpHeader.appendChild(chamberPopUpHeaderText);

            var chamberPopUpBody = document.createElement('div');
            chamberPopUpBody.className = 'chamberPopUp-Body';
            chamberPopUpContent.appendChild(chamberPopUpBody);

            // var chamberPopUpBodyFiller = document.createElement('p');
            // chamberPopUpBodyFiller.innerHTML = 'Test Modal Body';
            // chamberPopUpBody.appendChild(chamberPopUpBodyFiller);

            var chamberPopUpFooter = document.createElement('div');
            chamberPopUpFooter.className = 'chamberPopUp-Footer'
            chamberPopUpContent.appendChild(chamberPopUpFooter);
            var chamberPopUpFooterText = document.createElement('h3');
            chamberPopUpFooterText.innerHTML = 'Settings For Your '+playerInfo.voreTypes[i].destination
            chamberPopUpFooter.appendChild(chamberPopUpFooterText);





            //----- Creating Settings Form to be displayed inside Modal -----//
              contentsList.className = 'contentsList';

              chamberSettings.className = 'chamberSettings';

              var settingsUl = document.createElement('ul');
              var settingsForm = document.createElement('form');
              settingsForm.id = playerInfo.voreTypes[i]._id;
              chamberSettings.appendChild(settingsForm);
              settingsForm.appendChild(settingsUl);

              var settingsLi = document.createElement('li');
          		var select = document.createElement("select");
              select.id = 'containerAction'+i;
          		settingsLi.innerHTML = "Is currently set to ";
          		var optionArray = ["Hold","Digest","Absorb","Transform"];
          		for (var sI = 0; sI < optionArray.length; sI++) {
          			var option = document.createElement("option");
          			option.value = optionArray[sI];
          			option.text = optionArray[sI];
          			select.appendChild(option);
          		}
          		settingsUl.appendChild(settingsLi);
          		settingsLi.appendChild(select);

              var settingsLi1 = document.createElement('li');
              var digestionTimer = document.createElement('input');
              digestionTimer.id = 'digestionTimer'+i;
              digestionTimer.name = 'digestionTimer';
              digestionTimer.type = 'number';
              digestionTimer.autocomplete = 'off';
              digestionTimer.className = 'form-control';
              digestionTimer.placeholder = 'Digestion Timer (In Seconds)';
              digestionTimer.ariaLabel = 'digestionTimer';
              digestionTimer.value = playerInfo.voreTypes[i].digestionTimer;
              settingsUl.appendChild(settingsLi1);
          		settingsLi1.appendChild(digestionTimer);

              var settingsLi2 = document.createElement('li');
              var leavesRemains = document.createElement('input');
              leavesRemains.id = 'leavesRemains'+i;
              leavesRemains.name = 'leavesRemains';
              leavesRemains.type = 'checkbox';
              leavesRemains.autocomplete = 'off';
              leavesRemains.className = 'form-control';
              //leavesRemains.placeholder = 'Digestion Timer (In Seconds)';
              leavesRemains.ariaLabel = 'leavesRemains';
              //leavesRemains.value = playerInfo.voreTypes[i].leavesRemains;
              settingsUl.appendChild(settingsLi2);
          		settingsLi2.appendChild(leavesRemains);

              var settingsLi3 = document.createElement('li');
          		var select2 = document.createElement("select");
              select2.id = 'containerAction'+i;
          		settingsLi3.innerHTML = "Remains type is ";
          		var optionArray2 = ["Cum","Urine","Scat","Other?"];
          		for (var sI = 0; sI < optionArray2.length; sI++) {
          			var option2 = document.createElement("option");
          			option2.value = optionArray2[sI];
          			option2.text = optionArray2[sI];
          			select2.appendChild(option2);
          		}
              settingsUl.appendChild(settingsLi3);
          		settingsLi3.appendChild(select2);

              var settingsLi4 = document.createElement('li');
          		var select3 = document.createElement("select");
              select3.id = 'containerAction'+i;
          		settingsLi4.innerHTML = "Remains exit your body from your ";
          		var optionArray3 = ["Butt","Penis","Vagina","Other?"];
          		for (var sI = 0; sI < optionArray3.length; sI++) {
          			var option3 = document.createElement("option");
          			option3.value = sI+1;
          			option3.text = optionArray3[sI];
          			select3.appendChild(option3);
          		}
              settingsUl.appendChild(settingsLi4);
          		settingsLi4.appendChild(select3);

              var settingsLi5 = document.createElement('li');
              var soulInteraction = document.createElement('input');
              settingsLi5.innerHTML = "Interacts with souls? Y/N ";
              soulInteraction.id = 'soulInteraction'+i;
              soulInteraction.name = 'soulInteraction';
              soulInteraction.type = 'checkbox';
              soulInteraction.autocomplete = 'off';
              soulInteraction.className = 'form-control';
              //soulInteraction.placeholder = 'Digestion Timer (In Seconds)';
              soulInteraction.ariaLabel = 'soulInteraction';
              //soulInteraction.value = playerInfo.voreTypes[i].soulInteraction;
              settingsUl.appendChild(settingsLi5);
          		settingsLi5.appendChild(soulInteraction);

              var settingsLi6 = document.createElement('li');
              var submitSettings = document.createElement('button');
              submitSettings.innerHTML = "Apply";
              submitSettings.id = 'applySettings'+i;
              submitSettings.className = 'applySettings';

              settingsUl.appendChild(settingsLi6);
          		settingsLi6.appendChild(submitSettings);

              chamberPopUpBody.appendChild(chamberSettings);




              //----- Creating a Chamber Descriptions Modal -----//
              var chamberDescriptionsPopUp = document.createElement('div');
              chamberDescriptionsPopUp.className = 'chamberDescriptionsPopUp';
              contentDiv.appendChild(chamberDescriptionsPopUp);
              var chamberDescriptionsPopUpContent = document.createElement('div');
              chamberDescriptionsPopUpContent.className = 'chamberPopUp-Content';
              chamberDescriptionsPopUp.appendChild(chamberDescriptionsPopUpContent);
              var chamberDescriptionsPopUpHeader = document.createElement('div');
              chamberDescriptionsPopUpHeader.className = 'chamberPopUp-header'
              chamberDescriptionsPopUpContent.appendChild(chamberDescriptionsPopUpHeader);
              var chamberDescriptionsPopUpCloseBtn = document.createElement("SPAN");
              chamberDescriptionsPopUpCloseBtn.id = 'chamberDescriptionsCloseID='+playerInfo.voreTypes[i]._id;
              chamberDescriptionsPopUpCloseBtn.className = 'close';
              chamberDescriptionsPopUpCloseBtn.innerHTML = '&times;'
              chamberDescriptionsPopUpHeader.appendChild(chamberDescriptionsPopUpCloseBtn);
              var chamberDescriptionsPopUpHeaderText = document.createElement('h2');
              chamberDescriptionsPopUpHeaderText.innerHTML = 'Descriptions For Your '+playerInfo.voreTypes[i].destination
              chamberDescriptionsPopUpHeader.appendChild(chamberDescriptionsPopUpHeaderText);

              var chamberDescriptionsPopUpBody = document.createElement('div');
              chamberDescriptionsPopUpBody.className = 'chamberPopUp-Body';
              chamberDescriptionsPopUpContent.appendChild(chamberDescriptionsPopUpBody);

              // var chamberPopUpBodyFiller = document.createElement('p');
              // chamberPopUpBodyFiller.innerHTML = 'Test Modal Body';
              // chamberPopUpBody.appendChild(chamberPopUpBodyFiller);

              var chamberDescriptionsPopUpFooter = document.createElement('div');
              chamberDescriptionsPopUpFooter.className = 'chamberPopUp-Footer'
              chamberDescriptionsPopUpContent.appendChild(chamberDescriptionsPopUpFooter);
              var chamberDescriptionsPopUpFooterText = document.createElement('h3');
              chamberDescriptionsPopUpFooterText.innerHTML = 'Descriptions For Your '+playerInfo.voreTypes[i].destination
              chamberDescriptionsPopUpFooter.appendChild(chamberDescriptionsPopUpFooterText);




              //----- Chamber Descriptions -----//
              var chamberDescriptions = document.createElement("div");
              chamberDescriptions.id = 'chamberDescriptions';

              var br2 = document.createElement('br');
              var br3 = document.createElement('br');
              var br4 = document.createElement('br');

              //var button = document.createElement("button");
              var examineButton = document.createElement('button');
              var struggleInsideButton = document.createElement('button');
              var struggleOutsideButton = document.createElement('button');
              var digestionInsideButton = document.createElement('button');
              var digestionOutsideButton = document.createElement('button');
              //var div = document.createElement("div");


              var examineMsgDiv = document.createElement("div");
              var examineContentDiv = document.createElement("div");
              var struggleInsideContentDiv = document.createElement("div");
              var struggleOutsideContentDiv = document.createElement("div");
              var digestionInsideContentDiv = document.createElement("div");
              var digestionOutsideContentDiv = document.createElement("div");

              var destination = document.createElement('input');
              var destinationDescripLbl = document.createElement('label');
              var destinationDescrip = document.createElement('textarea');


              var digestionTimerLbl = document.createElement('label');

              var animationLbl = document.createElement('label');

              var examineMsgLbl = document.createElement('label');
              var examineMsgDescrip = document.createElement('textarea');
              var struggleInsideMsgLbl = document.createElement('label');
              var struggleInsideMsgDescrip = document.createElement('textarea');
              var struggleOutsideMsgLbl = document.createElement('label');
              var struggleOutsideMsgDescrip = document.createElement('textarea');
              var digestionInsideMsgLbl = document.createElement('label');
              var digestionInsideMsgDescrip = document.createElement('textarea');
              var digestionOutsideMsgLbl = document.createElement('label');
              var digestionOutsideMsgDescrip = document.createElement('textarea');

              //li.className = "voreListItem";

              // button.id = 'voreOption'+i;
              // button.className = 'voreTypecollapsible';
              // button.type = 'button';
              // button.innerHTML = "<h1>" + playerInfo.voreTypes[i].destination; + "</h1>"
              // chamberDescriptions.appendChild(button);

              // div.id = 'content'+i;
              // div.className = "voreTypecontent";
              var div2 = document.createElement("div");
              div2.id = 'voreClassifiers'+i;
              div2.className = 'voreClassifiers';
              chamberDescriptions.appendChild(div2);

              var div3 = document.createElement("div");
              div3.className = 'activityMessages'
              chamberDescriptions.appendChild(div3);

              var destinationLbl = document.createElement('label');
              destinationLbl.innerHTML = 'Destination: ';
              destinationLbl.htmlFor = 'destination'+i;
              div2.appendChild(destinationLbl);
              //onkeyup='updateBttnName(event)'
              destination.id = 'destination'+i;
              destination.name = 'destination';
              //destination.onkeyup = updateBttnName;
              destination.type = 'text';
              destination.autocomplete = 'off';
              destination.className = 'form-control';
              destination.placeholder = 'Destination';
              destination.ariaLabel = 'Destination';
              destination.value = playerInfo.voreTypes[i].destination;
              div2.appendChild(destination);

              var br = document.createElement('br');
              div2.appendChild(br);

              var verbLbl = document.createElement('label');
              verbLbl.innerHTML = 'Verb: ';
              verbLbl.htmlFor = 'verb'+i;
              div2.appendChild(verbLbl);

              var verb = document.createElement('input');
              verb.id = 'verb'+i;
              verb.name = 'verb';
              verb.type = 'text';
              verb.autocomplete = 'off';
              verb.className = 'form-control';
              verb.placeholder = 'Destination Verb...';
              verb.ariaLabel = 'verb';
              verb.value = playerInfo.voreTypes[i].verb;
              div2.appendChild(verb);
              div2.appendChild(br2);

              var digestionTimerTextNode = document.createTextNode ('Digestion Timer: ');
              div2.appendChild(digestionTimerTextNode);

              var digestionTimer = document.createElement('input');
              digestionTimer.id = 'digestionTimer'+i;
              digestionTimer.name = 'digestionTimer';
              digestionTimer.type = 'number';
              digestionTimer.autocomplete = 'off';
              digestionTimer.className = 'form-control';
              digestionTimer.placeholder = 'Digestion Timer (In Seconds)';
              digestionTimer.ariaLabel = 'digestionTimer';
              digestionTimer.value = playerInfo.voreTypes[i].digestionTimer;
              div2.appendChild(digestionTimer);
              div2.appendChild(br3);

              var animationTextNode = document.createTextNode ('Animation: ');
              div2.appendChild(animationTextNode);

              var animation = document.createElement('select');
              animation.id = 'animation'+i;
              animation.name = 'animation';
              animation.innerHTML = '<option value="1">Oral Vore</option><option value="2">Anal Vore</option><option value="3">Cock Vore</option><option value="4">Unbirth</option><option value="5">Tail Vore</option><option value="6">Absorbtion</option>';
              animation.value = playerInfo.voreTypes[i].animation;
              div2.appendChild(animation);
              div2.appendChild(br4);

              destinationDescrip.id = 'destinationDescrip'+i;
              destinationDescrip.name = 'destinationDescrip';
              destinationDescrip.autocomplete = 'off';
              destinationDescrip.className = 'form-control';
              destinationDescrip.placeholder = "Describe the inside of the prey's destination...";
              destinationDescrip.areaLabel = 'destinationDescrip';
              destinationDescrip.innerHTML = playerInfo.voreTypes[i].destinationDescrip;
              div2.appendChild(destinationDescrip);

              examineButton.id = 'examineButton'+i;
              examineButton.className = 'actMsgcollapsible';
              examineButton.type = 'button';
              examineButton.innerHTML = "Examine Messages";
              div3.appendChild(examineButton);

              examineMsgDiv.className = 'actMsgcontent';
              //examineMsgDiv.innerHTML = 'testing activity messages';
              examineMsgLbl.innerHTML = 'Describe what people would see when examining you while this destination is "full":';
              examineMsgLbl.htmlFor = 'examineMsgDescrip'+i;
              examineMsgDiv.appendChild(examineMsgLbl);
              examineMsgDescrip.id = 'examineMsgDescrip'+i;
              examineMsgDescrip.name = 'examineMsgDescrip';
              examineMsgDescrip.autocomplete = 'off';
              examineMsgDescrip.className = 'form-control';
              examineMsgDescrip.placeholder = 'What do you look like when this destination is "full"?';
              examineMsgDescrip.areaLabel = 'examineMsgDescrip';
              examineMsgDescrip.innerHTML = playerInfo.voreTypes[i].examineMsgDescrip;
              examineMsgDiv.appendChild(examineMsgDescrip);
              div3.appendChild(examineMsgDiv);

              struggleInsideButton.id = 'struggleInsideMsgButton'+i;
              struggleInsideButton.className = 'actMsgcollapsible';
              struggleInsideButton.type = 'button';
              struggleInsideButton.innerHTML = "Struggle Messages (Interior)";
              div3.appendChild(struggleInsideButton);

              struggleInsideContentDiv.className = 'actMsgcontent';
              //struggleInsideMsgDiv.innerHTML = 'testing activity messages';
              struggleInsideMsgLbl.innerHTML = 'Describe what your prey experiances when struggling:';
              struggleInsideMsgLbl.htmlFor = 'struggleInsideMsgDescrip'+i;
              struggleInsideContentDiv.appendChild(struggleInsideMsgLbl);
              struggleInsideMsgDescrip.id = 'struggleInsideMsgDescrip'+i;
              struggleInsideMsgDescrip.name = 'struggleInsideMsgDescrip';
              struggleInsideMsgDescrip.autocomplete = 'off';
              struggleInsideMsgDescrip.className = 'form-control';
              struggleInsideMsgDescrip.placeholder = 'What does your prey experiance when struggling while inside this destination?';
              struggleInsideMsgDescrip.areaLabel = 'struggleInsideMsgDescrip';
              struggleInsideMsgDescrip.innerHTML = playerInfo.voreTypes[i].struggleInsideMsgDescrip;
              struggleInsideContentDiv.appendChild(struggleInsideMsgDescrip);
              div3.appendChild(struggleInsideContentDiv);

              struggleOutsideButton.id = 'struggleOutsideMsgButton'+i;
              struggleOutsideButton.className = 'actMsgcollapsible';
              struggleOutsideButton.type = 'button';
              struggleOutsideButton.innerHTML = "Struggle Messages (Exterior)";
              div3.appendChild(struggleOutsideButton);

              struggleOutsideContentDiv.className = 'actMsgcontent';
              //struggleOutsideMsgDiv.innerHTML = 'testing activity messages';
              struggleOutsideMsgLbl.innerHTML = 'Describe what an outside onlooker may see when your prey is struggling inside this destination:';
              struggleOutsideMsgLbl.htmlFor = 'struggleOutsideMsgDescrip'+i;
              struggleOutsideContentDiv.appendChild(struggleOutsideMsgLbl);
              struggleOutsideMsgDescrip.id = 'struggleOutsideMsgDescrip'+i;
              struggleOutsideMsgDescrip.name = 'struggleOutsideMsgDescrip';
              struggleOutsideMsgDescrip.autocomplete = 'off';
              struggleOutsideMsgDescrip.className = 'form-control';
              struggleOutsideMsgDescrip.placeholder = 'What do others see when prey is struggling in here?';
              struggleOutsideMsgDescrip.areaLabel = 'struggleOutsideMsgDescrip';
              struggleOutsideMsgDescrip.innerHTML = playerInfo.voreTypes[i].struggleOutsideMsgDescrip;
              struggleOutsideContentDiv.appendChild(struggleOutsideMsgDescrip);
              div3.appendChild(struggleOutsideContentDiv);

              digestionInsideButton.id = 'digestionInsideMsgButton'+i;
              digestionInsideButton.className = 'actMsgcollapsible';
              digestionInsideButton.type = 'button';
              digestionInsideButton.innerHTML = "Digestion Messages (Interior)";
              div3.appendChild(digestionInsideButton);

              digestionInsideContentDiv.className = 'actMsgcontent';
              //digestionInsideMsgDiv.innerHTML = 'testing activity messages';
              digestionInsideMsgLbl.innerHTML = 'Describe what your prey may experiance in their final moments as they are digested in this destination:';
              digestionInsideMsgLbl.htmlFor = 'digestionInsideMsgDescrip'+i;
              digestionInsideContentDiv.appendChild(digestionInsideMsgLbl);
              digestionInsideMsgDescrip.id = 'digestionInsideMsgDescrip'+i;
              digestionInsideMsgDescrip.name = 'digestionInsideMsgDescrip';
              digestionInsideMsgDescrip.autocomplete = 'off';
              digestionInsideMsgDescrip.className = 'form-control';
              digestionInsideMsgDescrip.placeholder = 'What does your prey experiance in the moment they are completely digested here?';
              digestionInsideMsgDescrip.areaLabel = 'digestionInsideMsgDescrip';
              digestionInsideMsgDescrip.innerHTML = playerInfo.voreTypes[i].digestionInsideMsgDescrip;
              digestionInsideContentDiv.appendChild(digestionInsideMsgDescrip);
              div3.appendChild(digestionInsideContentDiv);

              digestionOutsideButton.id = 'digestionOutsideMsgButton'+i;
              digestionOutsideButton.className = 'actMsgcollapsible';
              digestionOutsideButton.type = 'button';
              digestionOutsideButton.innerHTML = "Digestion Messages (Exterior)";
              div3.appendChild(digestionOutsideButton);

              digestionOutsideContentDiv.className = 'actMsgcontent';
              //digestionOutsideMsgDiv.innerHTML = 'testing activity messages';
              digestionOutsideMsgLbl.innerHTML = 'Describe what an outside onlooker may notice as this destination finishes digetsing your prey:';
              digestionOutsideMsgLbl.htmlFor = 'digestionOutsideMsgDescrip'+i;
              digestionOutsideContentDiv.appendChild(digestionOutsideMsgLbl);
              digestionOutsideMsgDescrip.id = 'digestionOutsideMsgDescrip'+i;
              digestionOutsideMsgDescrip.name = 'digestionOutsideMsgDescrip';
              digestionOutsideMsgDescrip.autocomplete = 'off';
              digestionOutsideMsgDescrip.className = 'form-control';
              digestionOutsideMsgDescrip.placeholder = 'What do others around you notice as you finish digesting prey here?';
              digestionOutsideMsgDescrip.areaLabel = 'digestionOutsideMsgDescrip';
              digestionOutsideMsgDescrip.innerHTML = playerInfo.voreTypes[i].digestionOutsideMsgDescrip;
              digestionOutsideContentDiv.appendChild(digestionOutsideMsgDescrip);
              div3.appendChild(digestionOutsideContentDiv);



              chamberDescriptionsPopUpBody.appendChild(chamberDescriptions);//chamberDescriptions





              li.appendChild(button);
              li.appendChild(contentDiv);

              //contentDiv.appendChild(exitButton);
              contentDiv.appendChild(chamberContents);

              chamberContents.appendChild(contentsList);



              document.getElementById("voreList").appendChild(li);
              document.getElementById(button.id).addEventListener("click", displayChamberContents);
              document.getElementById('chamberSettingsID='+localPlayerInfo.voreTypes[i]._id).addEventListener("click", displayChamberSettings);
              document.getElementById('chamberSettingsCloseID='+localPlayerInfo.voreTypes[i]._id).addEventListener("click", closeDisplayChamberSettings);
              document.getElementById('chamberDescriptionsID='+localPlayerInfo.voreTypes[i]._id).addEventListener("click", displayChamberSettings);
              document.getElementById('chamberDescriptionsCloseID='+localPlayerInfo.voreTypes[i]._id).addEventListener("click", closeDisplayChamberSettings);
            }

            //----- Displays the contents of a given chamber in the vore menu -----//
            function displayChamberContents(e) {
              var selectedVoreAnatomy = e.target.id.replace("vorcordionID=", "")
              console.log('displayChamberContents ID = ', selectedVoreAnatomy);
              var chamberContentsList = document.getElementById("chamberContentsList");
              chamberContentsList.innerHTML = "";

              //----- Checking clicked option ID against player vore ID to find the match -----//
              for (i = 0; i < localPlayerInfo.voreTypes.length; i++) {
                if (localPlayerInfo.voreTypes[i]._id == selectedVoreAnatomy) {
                  //----- Check if selected chamber has prey inside. If yes, displays the names of prey in the chamber contents list -----//
                  if(!localPlayerInfo.voreTypes[i].contents) {
                    console.log('This chamber is empty');
                    chamberContentsList.innerHTML = 'There is nothing inside of your ' + localPlayerInfo.voreTypes[i].destination;
                  } else {
                    for (p = 0; p < localPlayerInfo.voreTypes[i].contents.length; p++) {
                      var displayChamberContentsLi = document.createElement("li");
                      displayChamberContentsLi.innerHTML = localPlayerInfo.voreTypes[i].contents[p];
                      chamberContentsList.appendChild(displayChamberContentsLi);
                    }
                  }
                }
              }
            }

            //----- Controls Chamber Modals -----//

            function displayChamberSettings(e) {
              var selectedVoreAnatomy = e.target.id.replace("chamberSettingsID=", "")
              var popUpModal = this.nextElementSibling.nextElementSibling;
              popUpModal.style.display = 'block';
              console.log('popUpModal = ', popUpModal);
              var popUpModalCloseBttn = popUpModal.children[0].children[0].children[1];//.child.children[1];

              console.log('popUpModalCloseBttn = ', popUpModalCloseBttn);
              console.log('test Successful. You clicked the settings button for selectedVoreAnatomy = ', selectedVoreAnatomy);
            }

            //----- Closes Chamber Modals -----//
            function closeDisplayChamberSettings(e) {
              var selectedVoreAnatomy = e.target.id.replace("chamberSettingsCloseID=", "")
              var popUpModal = this.parentElement.parentElement.parentElement;
              console.log('close button clicked');
              popUpModal.style.display = 'none';
            }


            var addVore = document.createElement('button');
            var liAddButton = document.createElement('li');
            addVore.className = "button main";
            addVore.id = "addVore";
            addVore.type = "button";
            addVore.innerHTML = 'Add New Vore';

            liAddButton.appendChild(addVore);

            document.getElementById("voreList").appendChild(liAddButton);

            //----- controls the expanding of the Vore Anatomy Buttons -----//
            accordions = document.getElementsByClassName('accordion');
            // console.log('accordions = ', accordions);
            if (!accordions) {
              accordions = 0;
            }
            for (i = 0; i < accordions.length; i++) {
              accordions[i].onclick = function () {
                // this.classList.toggle('is-open');
                var content = this.nextElementSibling;
                // console.log('accordions = ', accordions[i]);
                // console.log('content = ', content);
                if (content.style.maxHeight) {
                  //accordion is open, we need to close it
                  this.classList.toggle('is-open');
                  content.style.maxHeight = null;
                } else {
                  //accordiion is closed
                  //content.style.maxHeight = content.scrollHeight + 'px';
                  otherContent = document.getElementsByClassName('accordion-content');
                  // console.log('otherContent = ', otherContent);
                  for (oC = 0; oC < otherContent.length; oC++){
                    // console.log('found other content');
                    var parentElement = otherContent[oC].previousSibling;
                    // console.log('parentElement = ', parentElement);
                    parentElement.classList.remove('is-open');
                    otherContent[oC].style.maxHeight = null;
                  }
                  content.style.maxHeight = '500px';
                  this.classList.toggle('is-open');
                }
              }
            }
            accordionCloseButton = document.getElementsByClassName('accordion-close-button');
            for (i = 0; i < accordionCloseButton.length; i++) {
              accordionCloseButton[i].onclick = function () {
                var content = this.parentElement;
                var accordion = content.previousSibling;
                // console.log('content = ', content);
                // console.log('accordion = ', accordion);
                accordion.classList.toggle('is-open');
                content.style.maxHeight = null;
              }
            }

            //----- Controls the expanding of the Action Messages inside the Chamber Descruptions Modal -----//
            actMsgcollapsible = document.getElementsByClassName('actMsgcollapsible');
            // console.log('actMsgcollapsible = ', actMsgcollapsible);
            if (!actMsgcollapsible) {
              actMsgcollapsible = 0;
            }
            for (i = 0; i < actMsgcollapsible.length; i++) {
              actMsgcollapsible[i].onclick = function () {
                // this.classList.toggle('is-open');
                var content = this.nextElementSibling;
                // console.log('actMsgcollapsible = ', actMsgcollapsible[i]);
                // console.log('content = ', content);
                if (content.style.maxHeight) {
                  //actMsgcollapsible is open, we need to close it
                  this.classList.toggle('is-open');
                  content.style.maxHeight = null;
                  content.style.display = 'none';
                  // console.log('actMsgcollapsible is open, we need to close it');
                } else {
                  //actMsgcollapsible is closed
                  //content.style.maxHeight = content.scrollHeight + 'px';
                  actMsgcontent = document.getElementsByClassName('actMsgcontent');
                  // console.log('actMsgcontent = ', actMsgcontent);
                  for (aMC = 0; aMC < actMsgcontent.length; aMC++){
                    // console.log('found actMsgcontent');
                    var parentElement = actMsgcontent[aMC].previousSibling;
                    // console.log('parentElement = ', parentElement);
                    parentElement.classList.remove('is-open');
                    actMsgcontent[aMC].style.maxHeight = null;
                    actMsgcontent[aMC].style.display = 'none';
                  }
                  content.style.maxHeight = '500px';
                  content.style.display = 'block';
                  this.classList.toggle('is-open');
                  // console.log('actMsgcollapsible is closed, setting content height to 500px to open');
                }
              }
            }
            actMsgcollapsibleCloseButton = document.getElementsByClassName('actMsgcollapsible-close-button');
            for (i = 0; i < actMsgcollapsibleCloseButton.length; i++) {
              actMsgcollapsibleCloseButton[i].onclick = function () {
                var content = this.parentElement;
                var actMsgcollapsible = content.previousSibling;
                // console.log('content = ', content);
                // console.log('actMsgcollapsible = ', actMsgcollapsible);
                actMsgcollapsible.classList.toggle('is-open');
                content.style.maxHeight = null;
              }
            }


            var voreForms = document.querySelectorAll('#voreList form');
            console.log('voreForms = ', voreForms);
            Array.from(voreForms).forEach(function(voreForm){
              voreForm.addEventListener('click', function(e){
                if(e.target.className == 'applySettings'){
                  e.preventDefault();
                  console.log('vore = ', voreForm.id);
                  //console.log('voreForm.value = ', voreForm.elements[0].value);
                  var voreUpdate = {
                    voreFormId: voreForm.id,
                    chamberSettings: voreForm.elements[0].value,
                    digestionTimer: voreForm.elements[1].value,
                    leavesRemains: voreForm.elements[2].value,
                    remainsType: voreForm.elements[3].value,
                    remainsExit: voreForm.elements[4].value,
                    soulInteraction: voreForm.elements[5].value,
                    token: document.cookie.replace('TastyTails=',''),
                    charId: document.location.href.split('play/')[1]
                  }

                  console.log(
                    'voreForm.id = ', voreUpdate.voreFormId, '\n',
                    'chamberSettings', voreUpdate.chamberSettings, '\n',
                    'digestionTimer', voreUpdate.digestionTimer, '\n',
                    'leavesRemains', voreUpdate.leavesRemains, '\n',
                    'remainsType', voreUpdate.remainsType, '\n',
                    'remainsExit', voreUpdate.remainsExit, '\n',
                    'soulInteraction', voreUpdate.soulInteraction, '\n'
                  );
                  const cookie = document.cookie;
                  self.socket.emit('voreUpdate', voreUpdate, cookie);
                }
              })
            })
          }
        };
      function displayOtherPlayers(self, playerInfo) {
        console.log("displayOtherPlayers function called");
        console.log('displayOtherPlayers function username = ', playerInfo.username);
        console.log('displayOtherPlayers function Head Tint = ', playerInfo.headColor);
        console.log('displayOtherPlayers function Head Tint = ', playerInfo.bodyColor);
        console.log('displayOtherPlayers function called and playerInfo.head = ', playerInfo.head, 'and, ', playerInfo.body);

        playerContainer = self.add.container(playerInfo.position.x, playerInfo.position.y);
        playerContainer.setSize(60, 163);
        // playerContainer.setSize(60, 15);
        playerContainer.setInteractive();
        self.physics.world.enable(playerContainer);
        playerContainer.body.setOffset(30, -66.5);
        playerContainer.input.hitArea.centerX = 60;
        playerContainer.input.hitArea.centerY = 15;
        // playerContainer.displayOriginX = 54.5;
        // playerContainer.displayOriginY = 110;
        console.log('player coordinates are: X= ', playerInfo.position.x, 'Y= ', playerInfo.position.y);
        //----- the 30, -87 defines the placement of the sprite in the container -----//
        const playerContainertail = self.add.sprite(30, -87, playerInfo.tail.sprite);
        playerContainertail.setTint(playerInfo.tail.color);
        console.log('playerContainertail = ', playerContainertail)
        const playerContainersecondaryTail = self.add.sprite(30, -87, playerInfo.tail.secondarySprite);
        playerContainersecondaryTail.setTint(playerInfo.tail.secondaryColor);
        const playerContaineraccentTail = self.add.sprite(30, -87, playerInfo.tail.accentSprite);
        playerContaineraccentTail.setTint(playerInfo.tail.accentColor);
        const playerContainerbody = self.add.sprite(30, -87, playerInfo.body.sprite);
        playerContainerbody.setTint(playerInfo.body.color);
        const playerContainersecondaryBody = self.add.sprite(30, -87, playerInfo.body.secondarySprite);
        playerContainersecondaryBody.setTint(playerInfo.body.secondaryColor);
        const playerContaineraccentBody = self.add.sprite(30, -87, playerInfo.body.accentSprite);
        playerContaineraccentBody.setTint(playerInfo.body.accentColor);
        const playerContainerhead = self.add.sprite(30, -87, playerInfo.head.sprite);
        playerContainerhead.setTint(playerInfo.head.color);
        const playerContainersecondaryHead = self.add.sprite(30, -87, playerInfo.head.secondarySprite);
        playerContainersecondaryHead.setTint(playerInfo.head.secondaryColor);
        const playerContaineraccentHead = self.add.sprite(30, -87, playerInfo.head.accentSprite);
        playerContaineraccentHead.setTint(playerInfo.head.accentColor);
        const playerContainerhair = self.add.sprite(30, -87, playerInfo.hair.sprite);
        playerContainerhair.setTint(playerInfo.hair.color);

        const playerContainerouterEar = self.add.sprite(30, -87, playerInfo.ear.outerSprite);
        playerContainerouterEar.setTint(playerInfo.ear.outerColor);
        const playerContainerinnerEar = self.add.sprite(30, -87, playerInfo.ear.innerSprite);
        playerContainerinnerEar.setTint(playerInfo.ear.innerColor);

        const playerContainereyes = self.add.sprite(30, -87, playerInfo.eyes.outer);
        const playerContaineriris = self.add.sprite(30, -87, playerInfo.eyes.iris);
        playerContaineriris.setTint(playerInfo.eyes.color);

        const playerContainergenitles = self.add.sprite(30, -87, playerInfo.genitles.sprite);
        // self.genitles.setTint(playerInfo.genitles.color);


        playerContainer.add([
        playerContainertail,
        playerContainersecondaryTail,
        playerContaineraccentTail,
        playerContainerbody,
        playerContainersecondaryBody,
        playerContaineraccentBody,
        playerContainerhead,
        playerContainerouterEar,
        playerContainerinnerEar,
        playerContainersecondaryHead,
        playerContaineraccentHead,
        playerContainereyes,
        playerContaineriris,
        playerContainerhair,
        playerContainergenitles
        ]);
        playerContainer.sendToBack(self.tail);

        playerContainer.playerId = playerInfo.playerId;
        self.players.add(playerContainer);





        playerContainer.on('pointerdown', function (pointer){
          if (pointer.rightButtonDown()) {
            clicked = playerInfo;
          } else {
            console.log('Other sprite was Left clicked');
          }
        });
      };

      function createAnimations(spriteKeys) {
      // console.log('spriteKeys = ', spriteKeys);
      // console.log('spriteKeys.length = ', spriteKeys.length);
      spriteKeys.forEach(key => {
        // console.log('key = ',key)
        self.anims.create({
          key: `${key}Down`, // Example animation key naming convention
          frames: self.anims.generateFrameNumbers(key, { start: 1, end: 8 }), // Adjust frame numbers as needed
          frameRate: 8,
          repeat: -1 // Loop the animation
        });

        self.anims.create({
          key: `${key}Right`, // Example animation key naming convention
          frames: self.anims.generateFrameNumbers(key, { start: 10, end: 17 }), // Adjust frame numbers as needed
          frameRate: 8,
          repeat: -1 // Loop the animation
        });

        self.anims.create({
          key: `${key}Left`, // Example animation key naming convention
          frames: self.anims.generateFrameNumbers(key, { start: 19, end: 26 }), // Adjust frame numbers as needed
          frameRate: 8,
          repeat: -1 // Loop the animation
        });

        self.anims.create({
          key: `${key}Up`, // Example animation key naming convention
          frames: self.anims.generateFrameNumbers(key, { start: 28, end: 35 }), // Adjust frame numbers as needed
          frameRate: 8,
          repeat: -1 // Loop the animation
        });

        self.anims.create({
          key: `${key}StopDown`, // Example animation key naming convention
          frames: self.anims.generateFrameNumbers(key, { start: 0, end: 0 }), // Adjust frame numbers as needed
          frameRate: 1,
          repeat: -1 // Loop the animation
        });

        self.anims.create({
          key: `${key}StopRight`, // Example animation key naming convention
          frames: self.anims.generateFrameNumbers(key, { start: 9, end: 9 }), // Adjust frame numbers as needed
          frameRate: 1,
          repeat: -1 // Loop the animation
        });

        self.anims.create({
          key: `${key}StopLeft`, // Example animation key naming convention
          frames: self.anims.generateFrameNumbers(key, { start: 18, end: 18 }), // Adjust frame numbers as needed
          frameRate: 1,
          repeat: -1 // Loop the animation
        });

        self.anims.create({
          key: `${key}StopUp`, // Example animation key naming convention
          frames: self.anims.generateFrameNumbers(key, { start: 27, end: 27 }), // Adjust frame numbers as needed
          frameRate: 1,
          repeat: -1 // Loop the animation
        });
      });
    }
    // console.log('spritesToAnimate = ', self.spritesToAnimate);
    createAnimations.call(self, self.spritesToAnimate);
    }

    function update() {
         
      //makes phaser stop listening for keyboard inputs when user is focused on the chat div
      // if (chatFocused == false) {
      //   this.input.keyboard.enabled = true;
      //   this.input.keyboard.addKey(this.cursors.up);
      //   this.input.keyboard.addKey(this.cursors.down);
      //   this.input.keyboard.addKey(this.cursors.left);
      //   this.input.keyboard.addKey(this.cursors.right);
      //   this.input.keyboard.addKey(this.cursors.space);
      //   // console.log('in game arrow keys enabled');
      // }
      // else {
      //   this.input.keyboard.removeKey(this.cursors.up);
      //   this.input.keyboard.removeKey(this.cursors.down);
      //   this.input.keyboard.removeKey(this.cursors.left);
      //   this.input.keyboard.removeKey(this.cursors.right);
      //   this.input.keyboard.removeKey(this.cursors.space);
      //   this.input.keyboard.enabled = false;
      //   // console.log('in game arrow keys disabled');
      // }


      //makes it so that variables left, right, up, and down are not checked for while undefined when user is focused on chat div
      if (avatarSelected == true) {
        //console.log('avatarSelected = ', avatarSelected);
        if (chatFocused == false) {
          //console.log('chatFocused = ', chatFocused);
          const left = this.leftKeyPressed;
          const right = this.rightKeyPressed;
          const up = this.upKeyPressed;
          const down = this.downKeyPressed;

          if (this.cursors.left.isDown && this.cursors.right.isDown) {
            this.leftKeyPressed = false;
            this.rightKeyPressed = false;
            // console.log('Left and Right Keys are pressed at the same time...');
          } else if (this.cursors.left.isDown) {
            this.leftKeyPressed = true;
            // console.log('Left Key only is pressed...');
          } else if (this.cursors.right.isDown) {
            this.rightKeyPressed = true;
            // console.log('Right Keyonly is pressed...');
          }

          if (this.cursors.up.isDown && this.cursors.down.isDown) {
            this.upKeyPressed = false;
            this.downKeyPressed = false;
            // console.log('Up and Down Keys are pressed at the same time...');
          } else if (this.cursors.up.isDown) {
            this.upKeyPressed = true;
            //console.log('Up Key only is pressed...');
          } else if (this.cursors.down.isDown) {
            this.downKeyPressed = true;
            // console.log('Down Keyonly is pressed...');
          }

          if (this.cursors.up.isUp) {
            this.upKeyPressed = false;
          }
          if (this.cursors.down.isUp) {
            this.downKeyPressed = false;
          }
          if (this.cursors.left.isUp) {
            this.leftKeyPressed = false;
          }
          if (this.cursors.right.isUp) {
            this.rightKeyPressed = false;
          }

          if (left !== this.leftKeyPressed || right !== this.rightKeyPressed || up !== this.upKeyPressed || down !== this.downKeyPressed) {
            this.socket.emit('playerInput', { left: this.leftKeyPressed , right: this.rightKeyPressed, up: this.upKeyPressed, down: this.downKeyPressed, door: localPlayerInfo.door });
            localPlayerInfo.door = '';
          }
        }
      }
    }
  </script>
</section>
